$(document).ready(function(){$("#mainform").removeClass("hidecontent"),$("body").scrollTop(),$("body").find("#session_error_panel").length>0?(objUtilities.isSessionValid=!1,objUtilities.showSessionPanel($("body"))):(objUtilities.isSessionValid=!0,objUtilities.triggerSessionValidEvent())});
/*!
** Unobtrusive drilldown event handler registration.
*/
function registerDrillDownEvent(n){function i(n,t){if(t.length>0)for(var i=0;i<t.length;i++)if(t[i].indexOf(n)==0)return t[i].split(":")[1];return null}function r(t,i){var r,u;IsComboBoxDrillDown()?(r=GetControl(t),r&&(r.val(i),r.attr("selectedIndex")>0&&r.trigger("change"))):(u=GetControl(t),n.each(u,function(){if(this.value==i)return this.checked=!0,$("input[name='"+t+"']").trigger("change"),!1}))}n.find('div[data-register-change-event="true"] :radio, select[data-register-change-event="true"]').each(function(){$(this).change(ShowNextLevel)});var t='[data-drilldowntype="true"][id*="_L1"]';n.find(t).each(function(){var n=$(this).attr("id"),t=GetDrillDownName(n);t!=""&&(n.toLowerCase().lastIndexOf("_options")>0?(drillDowns[t]="radiobutton",isHorizontal=GetControl(n).attr("data-ishorizontal")):drillDowns[t]="combobox",drillDownsCount++)}),n.find(t).each(function(){var c=$(this).attr("id"),t=GetDrillDownName(c),o,s,h,l,u,e,f;if(t!=""){currentDrillDownName=t,o=GetJsonDataObj(t),s=GetCurrentJsonDataObj(t,GetLevelNumber(c)),s&&$(this).attr("title",s.Title);try{if(o[2].DrillDownSelectedValues.length>0&&(h=n.find('[data-drilldowntype="true"][id*="'+t+'_L"]'),h)){for(l=o[2].DrillDownSelectedValues.split(","),u="",finalLevelReached=!1,isPreLoadedChangeEvent=!0,e=0;e<h.length;e++)if(drillDownControlId=t+"_L"+(e+1),f=i(drillDownControlId,l),f!=null&&f!="__value"&&f.length>0&&(r(drillDownControlId,f),finalLevelReached)){u=f;break}u!=null&&u!="__value"&&u.length>0&&GetControlById(t).val(u).trigger("change"),isPreLoadedChangeEvent=!1}}catch(a){}}})}function GetFirstItem(n){var t=GetJsonDataObj(n);return firstItem=t[1].FirstItem}function GetJsonDataObj(n){return jsonDataObj[n]=jQuery.parseJSON(window[n+"_JsonData"]),jsonDataObj[n]}function HasChildren(n){var t;for(t in n)return t==null?!1:!0;return!1}function IsComboBoxDrillDown(){return drillDowns[currentDrillDownName]=="combobox"?!0:!1}function GetId(n){return IsComboBoxDrillDown()?n.id:n.name}function GetControl(n){return IsComboBoxDrillDown()?$("#"+n):$("input[name='"+n+"']")}function ShowNextLevel(){var w=$(this).attr("id"),r=GetDrillDownName(w),s,n,o,t,h,l,k,a,v,u,e,f;if(currentDrillDownName=r,GetControlById(GetNextLevelId(GetId(this))).val("__value"),s=GetId(this)+"_span_DescriptionLabel",n=$("#"+s),n&&n[0]&&(n[0].innerHTML=""),HideSubDrillDownControls(GetId(this)),IsComboBoxDrillDown()&&this.selectedIndex<=0){for(o=GetId(this),t="",i=GetLevelNumber(o);i<5;i++)t=GetNextLevelId(o),h=GetControl(t),h&&h.val("__value"),o=t;return isPreLoadedChangeEvent==!1&&GetControlById(GetDrillDownName(GetId(this))).val("").trigger("change"),!1}var c=GetLevelNumber(GetId(this)),b=$("#"+GetId(this)+"_div"),y=GetCurrentJsonDataObj(r,c);if(t=GetNextLevelId(GetId(this)),n.length<=0){for(n=document.createElement("span"),n.id=s,l="",k="",l=y.Items[GetSelectedIndex(r,c)].Description,DecodedString=l.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'"),n.innerHTML=DecodedString,u=GetLevelNumber(t),e=1;e<u;e++)$(n).css("color","black");f=GetCurrentJsonDataObj(r,u),f==null&&(n.id.indexOf("AdvisorySupportTopics")>-1||n.id.indexOf("PgmMembershipSupportTopics")>-1||n.id.indexOf("OCISupportTopics")>-1)&&$(n).css("color","red")}if(n[0]){for(a="",v="",a=y.Items[GetSelectedIndex(r,c)].Description,v=a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'"),n[0].innerHTML=v,u=GetLevelNumber(t),e=1;e<u;e++)$(n[0]).css("color","black");f=GetCurrentJsonDataObj(r,u),f==null&&(n[0].id.indexOf("AdvisorySupportTopics")>-1||n[0].id.indexOf("PgmMembershipSupportTopics")>-1||n[0].id.indexOf("OCISupportTopics")>-1)&&$(n[0]).css("color","red")}if(b.append(n),GetDivControl(t).length>0){var p=t+"_Label",u=GetLevelNumber(t),f=GetCurrentJsonDataObj(r,u);HasChildren(f)?(IsComboBoxDrillDown()?PopulateToComboBox(t,p,f):PopulateToRadioButtonGroup(t,p,f),ReplaceClass(t+"_div","show","hide"),isPreLoadedChangeEvent==!1&&GetControlById(r).val()!="__value"&&GetControlById(r).val("__value").trigger("change")):(isPreLoadedChangeEvent==!1&&(ClearComboBox(t),GetControlById(r).val($(this).val()).trigger("change")),finalLevelReached=!0)}else isPreLoadedChangeEvent==!1&&(ClearComboBox(t),GetControlById(r).val($(this).val()).trigger("change")),finalLevelReached=!0}function GetSelectedIndex(n,t){if(IsComboBoxDrillDown())return $("#"+n+"_L"+t).attr("selectedIndex")-1;var i=0,r=!1;return GetControl(n+"_L"+t).each(function(){r||$(this).attr("type")=="radio"&&($(this).is(":checked")?r=!0:i++)}),i}function GetCurrentJsonDataObj(n,t){var i=GetJsonDataObj(n)[0],u,r;if(i!=null)for(r=1;r<t;r++){if(u=GetSelectedIndex(n,r),u<0)return null;i=i.Items[u].NextLevel}return i}function PopulateToComboBox(n,t,i){var f,r,u;if(i!=null)for(f=i.Title+"&nbsp;",$("#"+t).html(f),r=$("#"+n),r.empty(),r.attr("title",i.Title),r.append("<option value=''>"+GetFirstItem(GetDrillDownName(n))+"<\/option>"),u=0;u<i.Items.length;u++)r.append("<option value='"+i.Items[u].Value+"'>"+i.Items[u].Text+"<\/option>")}function ClearComboBox(n){while($("#"+n+"_div").length>0){var t=$("#"+n);t.length>0&&(t.empty(),t.append("<option value='__value'><\/option>")),n=GetNextLevelId(n)}}function PopulateToRadioButtonGroup(n,t,i){var f,u,r;if(i!=null){for(f=i.Title+"&nbsp;",$("#"+t).html(f),u=GetControlById(n+"_Options"),u.find("div:first").empty(),r=i.Items.length-1;r>=0;r--)u.find("div:first").prepend("<label id='"+n+"_"+r+"_Label' class='oasp-label' for='"+n+"_"+r+"'>"+i.Items[r].Text+"<\/label>"),u.find("div:first").prepend("<input id='"+n+"_"+r+"' class='oasp-radiobutton' type='radio' value='"+i.Items[r].Value+"' name='"+n+"'/>"),isHorizontal=="false"&&u.find("div:first").prepend("<div>");$(document).ready(function(){$("input[name='"+n+"']").change(ShowNextLevel)})}}function HideSubDrillDownControls(n){for(var r=GetLevelNumber(n),t=GetNextLevelId(n),i;$("#"+t+"_div").length>0;)SetFirstItemValue(t),ReplaceClass(t+"_div","hide","show"),i=$("#"+t+"_span_DescriptionLabel"),i&&i[0]&&(i[0].innerHTML=""),t=GetNextLevelId(t)}function SetFirstItemValue(n){if(IsComboBoxDrillDown())$("#"+n+" :first").val("__value");else{var t=GetControlById(n+"_Options");t.find("div input:first").attr("checked",!0)}}function ReplaceClass(n,t,i){var r=$("#"+n);r.removeClass(i),r.addClass(t)}function GetNextLevelId(n){var t=GetLevelNumber(n);return n.substring(0,n.length-1)+(parseInt(t)+1)}function GetLevelNumber(n){return n.substring(n.length-1)}function GetDrillDownName(n){var t=n.lastIndexOf("_L");return n.substring(0,t)}function GetControlById(n){return $("#"+n)}function GetDivControl(n){return GetControlById(n+"_div")}$(document).bind("ready",function(){registerDrillDownEvent($("body")),objUtilities.RegisterEventHandlers.push(function(n){registerDrillDownEvent(n)})});var jsonDataObj={},drillDowns={},drillDownsCount=0,currentDrillDownName="",isPreLoadedChangeEvent=!1,finalLevelReached=!1,isHorizontal="true";
function parseAjaxPanel(n){n.find("div[data-ajaxpanel=true]").each(function(){attachHandler($(this))}),n.attr("data-ajaxpanel")=="true"&&attachHandler(n)}function attachHandler(n){for(var i=n,f=i.attr("data-ajax-triggerid").split(" "),u,t,r=0;r<f.length;r++)u=f[r],t="#"+u,$(t).length==0&&(t='input[name="'+u+'"]'),$(t).unbind(i.attr("data-ajax-triggerevent"),ajaxPanelHandler),$(t).bind(i.attr("data-ajax-triggerevent"),{trid:u,pnl:i},ajaxPanelHandler)}function ajaxPanelHandler(n,t){var r="true",i=n.data.pnl.attr("id"),u=n.data.trid,f=n.data.pnl,e,o,s;try{r=getPostChildrenData(n.data.pnl)}catch(h){}(r.toLowerCase()==="false"||r===!1)&&$("#"+i).empty(),e=$("form"),o=e.serializeArray(),$("#"+i).empty(),n.data.pnl.addClass("loading"),s="format=partial&data-ajax-id="+escape(n.data.pnl.attr("id"))+"&data-ajax-triggerid="+escape(n.data.trid),t===undefined&&(t=!0),$("[class*='ajax-error']").hide(),$.ajax({async:t,type:"POST",url:GetUrl($("#"+i),s),data:o,success:function(n){if($(n).find("#session_error_panel").length>0)objUtilities.isSessionValid=!1,objUtilities.showSessionPanel($(n));else{objUtilities.isSessionValid=!0,$(n).find("#error_panel").length>0?(f.removeClass("loading"),$(".ajax-error-"+i).length>0?$(".ajax-error-"+i).show():$(".ajax-error-generic").show()):$(document).trigger(i+"_success",[u]),n.indexOf("checked")>-1&&(n=n.replace('checked="checked"',""));var t="div[data-ajax-triggerid~="+u+"]";$("body").find(t).each(function(){var t=$(this);t.replaceWith($(n).filter(function(){return $("div[id="+t.attr("id")+"]",this)})),parseAjaxPanel($("body")),registerNewElementEvents($("div[id="+t.attr("id")+"]"))})}},error:function(){f.removeClass("loading"),$(".ajax-error-"+i).length>0?$(".ajax-error-"+i).show():$(".ajax-error-generic").show(),$(document).trigger(i+"_error",[u])}})}function getPostChildrenData(n){var i=n.attr("data-ajax-adddata"),r=!1,t;if(i)try{t=$.parseJSON(i),t&&$.each(t,function(n,t){t&&t.name==="PostChildrenData"&&(r=t.value)})}catch(u){}return r}function registerNewElementEvents(n){$.each(objUtilities.RegisterEventHandlers,function(t,i){i(n)}),objUtilities.updateValidators()}function GetUrl(n,t){var r="",i=n.attr("data-currenturl");return r=i&&i.indexOf("?")==-1?"?":"&",i+r+t}function resetRadioButtons(){$('input[type="radio"]').attr("checked",!1)}$(function(){parseAjaxPanel($("body"))});
(function(n){n.extend(n.fn,{validate:function(t){if(!this.length){t&&t.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var i=n.data(this[0],"validator");return i?i:(i=new n.validator(t,this[0]),n.data(this[0],"validator",i),i.settings.onsubmit&&(this.find("input, button").filter(".cancel").click(function(){i.cancelSubmit=!0}),i.settings.submitHandler&&this.find("input, button").filter(":submit").click(function(){i.submitButton=this}),this.submit(function(t){function r(){if(i.settings.submitHandler){if(i.submitButton)var t=n("<input type='hidden'/>").attr("name",i.submitButton.name).val(i.submitButton.value).appendTo(i.currentForm);return i.settings.submitHandler.call(i,i.currentForm),i.submitButton&&t.remove(),!1}return!0}return(i.settings.debug&&t.preventDefault(),i.cancelSubmit)?(i.cancelSubmit=!1,r()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):r():(i.focusInvalid(),!1)})),i)},valid:function(){if(n(this[0]).is("form"))return this.validate().form();var t=!0,i=n(this[0].form).validate();return this.each(function(){t&=i.element(this)}),t},removeAttrs:function(t){var i={},r=this;return n.each(t.split(/\s/),function(n,t){i[t]=r.attr(t),r.removeAttr(t)}),i},rules:function(t,i){var r=this[0],o,u,h;if(t){var e=n.data(r.form,"validator").settings,s=e.rules,f=n.validator.staticRules(r);switch(t){case"add":n.extend(f,n.validator.normalizeRule(i)),s[r.name]=f,i.messages&&(e.messages[r.name]=n.extend(e.messages[r.name],i.messages));break;case"remove":return i?(o={},n.each(i.split(/\s/),function(n,t){o[t]=f[t],delete f[t]}),o):(delete s[r.name],f)}}return u=n.validator.normalizeRules(n.extend({},n.validator.metadataRules(r),n.validator.classRules(r),n.validator.attributeRules(r),n.validator.staticRules(r)),r),u.required&&(h=u.required,delete u.required,u=n.extend({required:h},u)),u}}),n.extend(n.expr[":"],{blank:function(t){return!n.trim(""+t.value)},filled:function(t){return!!n.trim(""+t.value)},unchecked:function(n){return!n.checked}}),n.validator=function(t,i){this.settings=n.extend(!0,{},n.validator.defaults,t),this.currentForm=i,this.init()},n.validator.format=function(t,i){return arguments.length==1?function(){var i=n.makeArray(arguments);return i.unshift(t),n.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!=Array&&(i=n.makeArray(arguments).slice(1)),i.constructor!=Array&&(i=[i]),n.each(i,function(n,i){t=t.replace(new RegExp("\\{"+n+"\\}","g"),i)}),t)},n.extend(n.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:n([]),errorLabelContainer:n([]),onsubmit:!0,ignore:[],ignoreTitle:!1,onfocusin:function(n){this.lastActive=n,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,n,this.settings.errorClass,this.settings.validClass),this.errorsFor(n).hide())},onfocusout:function(n){!this.checkable(n)&&(n.name in this.submitted||!this.optional(n))&&this.element(n)},onkeyup:function(n){(n.name in this.submitted||n==this.lastElement)&&this.element(n)},onclick:function(n){n.name in this.submitted?this.element(n):n.parentNode.name in this.submitted&&this.element(n.parentNode)},highlight:function(t,i,r){n(t).addClass(i).removeClass(r),n(t).attr("aria-invalid","true")},unhighlight:function(t,i,r){n(t).removeClass(i).addClass(r),n(t).attr("aria-invalid","false")}},setDefaults:function(t){n.extend(n.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:n.validator.format("Please enter no more than {0} characters."),minlength:n.validator.format("Please enter at least {0} characters."),rangelength:n.validator.format("Please enter a value between {0} and {1} characters long."),range:n.validator.format("Please enter a value between {0} and {1}."),max:n.validator.format("Please enter a value less than or equal to {0}."),min:n.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function r(t){var i=n.data(this[0].form,"validator"),r="on"+t.type.replace(/^validate/,"");i.settings[r]&&i.settings[r].call(i,this[0])}var i,t;this.labelContainer=n(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||n(this.currentForm),this.containers=n(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset(),i=this.groups={},n.each(this.settings.groups,function(t,r){n.each(r.split(/\s/),function(n,r){i[r]=t})}),t=this.settings.rules,n.each(t,function(i,r){t[i]=n.validator.normalizeRule(r)}),n(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",r).validateDelegate(":radio, :checkbox, select, option","click",r),this.settings.invalidHandler&&n(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),n.extend(this.submitted,this.errorMap),this.invalid=n.extend({},this.errorMap),this.valid()||n(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var n=0,t=this.currentElements=this.elements();t[n];n++)this.check(t[n]);return this.valid()},element:function(t){t=this.clean(t),this.lastElement=t,this.prepareElement(t),this.currentElements=n(t);var i=this.check(t);return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){n.extend(this.errorMap,t),this.errorList=[];for(var i in t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=n.grep(this.successList,function(n){return!(n.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){n.fn.resetForm&&n(this.currentForm).resetForm(),this.submitted={},this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(n){var t=0,i;for(i in n)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{n(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&n.grep(this.errorList,function(n){return n.element.name==t.name}).length==1&&t},elements:function(){var t=this,i={};return n([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return(!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!t.objectLength(n(this).rules()))?!1:(i[this.name]=!0,!0)})},clean:function(t){return n(t)[0]},errors:function(){return n(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=n([]),this.toHide=n([]),this.currentElements=n([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(n){this.reset(),this.toHide=this.errorsFor(n)},check:function(t){var i,r,u,f;t=this.clean(t),this.checkable(t)&&(t=this.findByName(t.name)[0]),i=n(t).rules(),r=!1;for(method in i){u={method:method,parameters:i[method]};try{if(f=n.validator.methods[method].call(this,t.value.replace(/\r/g,""),t,u.parameters),f=="dependency-mismatch"){r=!0;continue}if(r=!1,f=="pending"){this.toHide=this.toHide.not(this.errorsFor(t));return}if(!f)return this.formatAndAdd(t,u),!1}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+t.id+", check the '"+u.method+"' method",e);throw e;}}if(!r)return this.objectLength(i)&&this.successList.push(t),!0},customMetaMessage:function(t,i){if(n.metadata){var r=this.settings.meta?n(t).metadata()[this.settings.meta]:n(t).metadata();return r&&r.messages&&r.messages[i]}},customMessage:function(n,t){var i=this.settings.messages[n];return i&&(i.constructor==String?i:i[t])},findDefined:function(){for(var n=0;n<arguments.length;n++)if(arguments[n]!==undefined)return arguments[n];return undefined},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customMetaMessage(t,i),!this.settings.ignoreTitle&&t.title||undefined,n.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"<\/strong>")},formatAndAdd:function(n,t){var i=this.defaultMessage(n,t.method),r=/\$?\{(\d+)\}/g;typeof i=="function"?i=i.call(this,t.parameters,n):r.test(i)&&(i=jQuery.format(i.replace(r,"{$1}"),t.parameters)),this.errorList.push({message:i,element:n}),this.errorMap[n.name]=i,this.submitted[n.name]=i},addWrapper:function(n){return this.settings.wrapper&&(n=n.add(n.parent(this.settings.wrapper))),n},defaultShowErrors:function(){for(var t,i,n=0;this.errorList[n];n++)t=this.errorList[n],this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(n=0;this.successList[n];n++)this.showLabel(this.successList[n]);if(this.settings.unhighlight)for(n=0,i=this.validElements();i[n];n++)this.settings.unhighlight.call(this,i[n],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return n(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var r=this.errorsFor(t);r.length?(r.removeClass().addClass(this.settings.errorClass),r.attr("generated")&&r.html(i)):(r=n("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:!0}).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(r).length||(this.settings.errorPlacement?this.settings.errorPlacement(r,n(t)):r.insertAfter(t))),!i&&this.settings.success&&(r.text(""),typeof this.settings.success=="string"?r.addClass(this.settings.success):this.settings.success(r)),this.toShow=this.toShow.add(r)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return n(this).attr("for")==i})},idOrName:function(n){return this.groups[n.name]||(this.checkable(n)?n.name:n.id||n.name)},checkable:function(n){return/radio|checkbox/i.test(n.type)},findByName:function(t){var i=this.currentForm;return n(document.getElementsByName(t)).map(function(n,r){return r.form==i&&r.name==t&&r||null})},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return n("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(n,t){return this.dependTypes[typeof n]?this.dependTypes[typeof n](n,t):!0},dependTypes:{boolean:function(n){return n},string:function(t,i){return!!n(t,i.form).length},"function":function(n,t){return n(t)}},optional:function(t){return!n.validator.methods.required.call(this,n.trim(t.value),t)&&"dependency-mismatch"},startRequest:function(n){this.pending[n.name]||(this.pendingRequest++,this.pending[n.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],i&&this.pendingRequest==0&&this.formSubmitted&&this.form()?(n(this.currentForm).submit(),this.formSubmitted=!1):!i&&this.pendingRequest==0&&this.formSubmitted&&(n(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return n.data(t,"previousValue")||n.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor==String?this.classRuleSettings[t]=i:n.extend(this.classRuleSettings,t)},classRules:function(t){var i={},r=n(t).attr("class");return r&&n.each(r.split(" "),function(){this in n.validator.classRuleSettings&&n.extend(i,n.validator.classRuleSettings[this])}),i},attributeRules:function(t){var i={},u=n(t),r;for(method in n.validator.methods)r=u.attr(method),r&&(i[method]=r);return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},metadataRules:function(t){if(!n.metadata)return{};var i=n.data(t.form,"validator").settings.meta;return i?n(t).metadata()[i]:n(t).metadata()},staticRules:function(t){var i={},r=n.data(t.form,"validator");return r.settings.rules&&(i=n.validator.normalizeRule(r.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return n.each(t,function(r,u){if(u===!1){delete t[r];return}if(u.param||u.depends){var f=!0;switch(typeof u.depends){case"string":f=!!n(u.depends,i.form).length;break;case"function":f=u.depends.call(i,i)}f?t[r]=u.param!==undefined?u.param:!0:delete t[r]}}),n.each(t,function(r,u){t[r]=n.isFunction(u)?u(i):u}),n.each(["minlength","maxlength","min","max"],function(){t[this]&&(t[this]=Number(t[this]))}),n.each(["rangelength","range"],function(){t[this]&&(t[this]=[Number(t[this][0]),Number(t[this][1])])}),n.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t.messages&&delete t.messages,t},normalizeRule:function(t){if(typeof t=="string"){var i={};n.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,r){n.validator.methods[t]=i,n.validator.messages[t]=r!=undefined?r:n.validator.messages[t],i.length<3&&n.validator.addClassRules(t,n.validator.normalizeRule(t))},methods:{required:function(t,i,r){if(!this.depend(r,i))return"dependency-mismatch";switch(i.nodeName.toLowerCase()){case"select":var u=n(i).val();return u&&u.length>0;case"input":if(this.checkable(i))return this.getLength(t,i)>0;default:return n.trim(t).length>0}},remote:function(t,i,r){var f,u,e;return this.optional(i)?"dependency-mismatch":(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=typeof r=="string"&&{url:r}||r,f.old!==t)?(f.old=t,u=this,this.startRequest(i),e={},e[i.name]=t,n.ajax(n.extend(!0,{url:r,mode:"abort",port:"validate"+i.name,dataType:"json",data:e,success:function(r){var e,h,s,o;u.settings.messages[i.name].remote=f.originalMessage,e=r===!0,e?(h=u.formSubmitted,u.prepareElement(i),u.formSubmitted=h,u.successList.push(i),u.showErrors()):(s={},o=f.message=r||u.defaultMessage(i,"remote"),s[i.name]=n.isFunction(o)?o(t):o,u.showErrors(s)),f.valid=e,u.stopRequest(i,e)}},r)),"pending"):this.pending[i.name]?"pending":f.valid},minlength:function(t,i,r){return this.optional(i)||this.getLength(n.trim(t),i)>=r},maxlength:function(t,i,r){return this.optional(i)||this.getLength(n.trim(t),i)<=r},rangelength:function(t,i,r){var u=this.getLength(n.trim(t),i);return this.optional(i)||u>=r[0]&&u<=r[1]},min:function(n,t,i){return this.optional(t)||n>=i},max:function(n,t,i){return this.optional(t)||n<=i},range:function(n,t,i){return this.optional(t)||n>=i[0]&&n<=i[1]},email:function(n,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(n)},url:function(n,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(n)},date:function(n,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(n))},dateISO:function(n,t){return this.optional(t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(n)},number:function(n,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(n)},digits:function(n,t){return this.optional(t)||/^\d+$/.test(n)},creditcard:function(n,t){var r,e,i;if(this.optional(t))return"dependency-mismatch";if(/[^0-9-]+/.test(n))return!1;var f=0,i=0,u=!1;for(n=n.replace(/\D/g,""),r=n.length-1;r>=0;r--)e=n.charAt(r),i=parseInt(e,10),u&&(i*=2)>9&&(i-=9),f+=i,u=!u;return f%10==0},accept:function(n,t,i){return i=typeof i=="string"?i.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||n.match(new RegExp(".("+i+")$","i"))},equalTo:function(t,i,r){var u=n(r).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){n(i).valid()});return t==u.val()}}}),n.format=n.validator.format})(jQuery),function(n){var i=n.ajax,t={};n.ajax=function(r){r=n.extend(r,n.extend({},n.ajaxSettings,r));var u=r.port;return r.mode=="abort"?(t[u]&&t[u].abort(),t[u]=i.apply(this,arguments)):i.apply(this,arguments)}}(jQuery),function(n){jQuery.event.special.focusin||jQuery.event.special.focusout||!document.addEventListener||n.each({focus:"focusin",blur:"focusout"},function(t,i){function r(t){return t=n.event.fix(t),t.type=i,n.event.handle.call(this,t)}n.event.special[i]={setup:function(){this.addEventListener(t,r,!0)},teardown:function(){this.removeEventListener(t,r,!0)},handler:function(t){return arguments[0]=n.event.fix(t),arguments[0].type=i,n.event.handle.apply(this,arguments)}}}),n.extend(n.fn,{validateDelegate:function(t,i,r){return this.bind(i,function(i){var u=n(i.target);if(u.is(t))return r.apply(u,arguments)})}})}(jQuery);
/*!
** Unobtrusive validation support library for jQuery and jQuery Validate
** Copyright (C) Microsoft Corporation. All rights reserved.
*/
(function(n){function i(n,t,i){n.rules[t]=i,n.message&&(n.messages[t]=n.message)}function s(n){return n.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}function f(n){return n.substr(0,n.lastIndexOf(".")+1)}function e(n,t){return n.indexOf("*.")===0&&(n=n.replace("*.",t)),n}function h(t,i){var r=n(this).find("[data-valmsg-for='"+i[0].name+"']"),u=n.parseJSON(r.attr("data-valmsg-replace"))!==!1;r.removeClass("field-validation-valid").addClass("field-validation-error"),t.data("unobtrusiveContainer",r),u?(r.empty(),t.removeClass("input-validation-error").appendTo(r)):t.hide()}function c(t,i){var u=n(this).find("[data-valmsg-summary=true]"),r=u.find("ul");r&&r.length&&i.errorList.length&&(r.empty(),u.addClass("validation-summary-errors").removeClass("validation-summary-valid"),n.each(i.errorList,function(){n("<li />").html(this.message).appendTo(r)}))}function l(t){var i=t.data("unobtrusiveContainer"),r=n.parseJSON(i.attr("data-valmsg-replace"));i&&(i.addClass("field-validation-valid").removeClass("field-validation-error"),t.removeData("unobtrusiveContainer"),r&&i.empty())}function o(t){var i=n(t),r=i.data(u);return r||(r={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:n.proxy(h,t),invalidHandler:n.proxy(c,t),messages:{},rules:{},success:n.proxy(l,t)},attachValidation:function(){i.validate(this.options)},validate:function(){return i.validate(),i.valid()}},i.data(u,r)),r}var r=n.validator,t,u="unobtrusiveValidation";r.unobtrusive={adapters:[],parseElement:function(t,i){var u=n(t),f=u.parents("form")[0],r,e,s;f&&(r=o(f),r.options.rules[t.name]=e={},r.options.messages[t.name]=s={},n.each(this.adapters,function(){var i="data-val-"+this.name,r=u.attr(i),o={};r!==undefined&&(i+="-",n.each(this.params,function(){o[this]=u.attr(i+this)}),this.adapt({element:t,form:f,message:r,params:o,rules:e,messages:s}))}),jQuery.extend(e,{__dummy__:!0}),i||r.attachValidation())},parse:function(t){n(t).find(":input[data-val=true]").each(function(){r.unobtrusive.parseElement(this,!0)}),n("form").each(function(){var n=o(this);n&&n.attachValidation()})}},t=r.unobtrusive.adapters,t.add=function(n,t,i){return i||(i=t,t=[]),this.push({name:n,params:t,adapt:i}),this},t.addBool=function(n,t){return this.add(n,function(r){i(r,t||n,!0)})},t.addMinMax=function(n,t,r,u,f,e){return this.add(n,[f||"min",e||"max"],function(n){var f=n.params.min,e=n.params.max;f&&e?i(n,u,[f,e]):f?i(n,t,f):e&&i(n,r,e)})},t.addSingleVal=function(n,t,r){return this.add(n,[t||"val"],function(u){i(u,r||n,u.params[t])})},r.addMethod("__dummy__",function(){return!0}),r.addMethod("regex",function(n,t,i){var r;return this.optional(t)?!0:(r=new RegExp(i).exec(n),r&&r.index===0&&r[0].length===n.length)}),t.addSingleVal("accept","exts").addSingleVal("regex","pattern"),t.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),t.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),t.add("equalto",["other"],function(t){var r=f(t.element.name),u=t.params.other,o=e(u,r),s=n(t.form).find(":input[name="+o+"]")[0];i(t,"equalTo",s)}),t.add("required",function(n){i(n,"required",!0)}),t.add("remote",["url","type","additionalfields"],function(t){var r={url:t.params.url,type:t.params.type||"GET",data:{}},u=f(t.element.name);n.each(s(t.params.additionalfields||t.element.name),function(i,f){var o=e(f,u);r.data[o]=function(){return n(t.form).find(":input[name='"+o+"']").val()}}),i(t,"remote",r)}),n(function(){r.unobtrusive.parse(document)})})(jQuery);
function registerTextAreaEvents(n){var t=$(n).find("textarea").each(function(){var t=$(this),n;t.attr("data-val-length-max")&&(n=parseInt(t.attr("data-val-length-max")),n>0&&t.change(function(){if(this.value.length>n){var t=this.value.substring(0,n),i=t.count("\n"),r=n-i;this.value=t.substring(0,r)}}))});attachTextAreaDisablePasteEvent(n),attachTextAreaCounterValidatorEvent(n)}function attachTextAreaDisablePasteEvent(n){$(n).find("input[type='text'],input[type='password'],textarea").each(function(){$(n).attr("data-disabledPaste")&&$(n).attr("data-disabledPaste")=="true"&&$(n).bind("paste",function(n){n.preventDefault()})})}function attachTextAreaCounterValidatorEvent(n){var t=$(n).find("input[data-val=true][type=hidden]").each(function(){var u=$(this),e,s,r;if(u.attr("data-val-count-controls")){var n=u.attr("data-val-remainingcharcount-control"),t=u.attr("data-val-usedcharcount-control"),i=parseInt(u.attr("data-val-length-max")),h=u.attr("data-val-count-controls"),f=h.split(","),o=GetSumOfControlsLength(f),c=i-o;for($("#"+n).length>0&&$("#"+n).text(c),$("#"+t).length>0&&$("#"+t).text(o),e=0;e<f.length;e++)s=$.trim(f[e]),r=GetControl(s),r!=null&&(r[0].tagName=="DIV"?r.find("input[type='text'],textarea").each(function(){$(this).bind("keyup keydown blur",{controlsId:f,control:$(this),totalMaxLength:i,remainingCountControl:n,usedCharCountControl:t},function(r){var e=parseInt(r.data.control.attr("data-val-length-max")),f=GetSumOfControlsLength(r.data.controlsId),u=i-f;if(u<=0){this.value=this.value.substring(0,r.data.control.val().length+u),$("#"+n).text("0"),$("#"+t).text(i);return}$("#"+n).text(u),$("#"+t).text(f)})}):r.bind("keyup keydown blur",{controlsId:f,control:r,totalMaxLength:i,remainingCountControl:n,usedCharCountControl:t},function(r){var e=parseInt(r.data.control.attr("data-val-length-max")),f=GetSumOfControlsLength(r.data.controlsId),u=i-f;if(u<0){this.value=this.value.substring(0,r.data.control.val().length+u),$("#"+n).text("0"),$("#"+t).text(i);return}$("#"+n).text(u),$("#"+t).text(f)}))}})}function CounterEventHandler(n){var r=parseInt(n.data.control.attr("data-val-length-max")),i=GetSumOfControlsLength(n.data.controlsId),t=totalMaxLength-i;if(t<0){this.value=this.value.substring(0,n.data.control.val().length+t),$("#"+remainingCountControl).text("0"),$("#"+usedCharCountControl).text(totalMaxLength);return}$("#"+remainingCountControl).text(t),$("#"+usedCharCountControl).text(i)}function GetSumOfControlsLength(n){for(var t=0,f,i,u,r=0;r<n.length;r++)f=$.trim(n[r]),i=GetControl(f),i!=null&&i.length>0&&(i[0].tagName=="DIV"?i.find("input[type='text'],textarea").each(function(){t=t+$(this)[0].value.length;var n=$(this).val().split(/\n/).length-1;n>0&&(t+=n)}):(t=t+i[0].value.length,u=i.val().split(/\n/).length-1,u>0&&(t+=u)));return t}function GetControl(n){if(n.length>0){var t=$("#"+n);return t.length<1?(t=$('[name="'+n+'"]'),t.length<1?null:t):t}return null}String.prototype.count=function(n){return(this.length-this.replace(new RegExp(n,"g"),"").length)/n.length},$(function(){registerTextAreaEvents($("body")),objUtilities.RegisterEventHandlers.push(function(n){registerTextAreaEvents(n)})});
function registerButtonEvents(n){var t=n.find("button").each(function(){var n=$(this),t=n.attr("data-redirect"),i;t&&n.click(function(){objUtilities.blockUI(),document.location=t}),i=n.attr("data-historyback"),i&&n.click(function(){objUtilities.blockUI(),history.back()})})}$(function(){registerButtonEvents($("body")),objUtilities.RegisterEventHandlers.push(function(n){registerButtonEvents(n)}),$("form").submit(function(){if($(this).validate){var n=$(this).validate();n&&n.form()&&objUtilities.blockUI()}})});
/*!
** Unobtrusive Timezone event handler registration.
*/
function registerTimeZoneEvents(n){n.find('select[class~="timezone"]').each(function(){var e=$("option:selected",$(this)),f;if(e.val()==""){var i=":00)",r=new Date,o=new Date(r.getFullYear(),0,1),s=new Date(r.getFullYear(),6,1),u=Math.max(o.getTimezoneOffset(),s.getTimezoneOffset()),t=u%60,n=(u-t)/60;if(t=Math.abs(t),0<=t&&t<=9&&(t="0"+t),i=":"+t+")",1<=n&&n<=9)n="(GMT-0"+n+i;else if(n>9)n="(GMT-"+n+i;else if(-9<=n&&n<=-1)n="(GMT+0"+-1*n+i;else if(n<-9)n="(GMT+"+-1*n+i;else if(n==0)n="(GMT)";else return;f=$("option",$(this)),f.each(function(){if($(this).text().indexOf(n)!=-1)return $(this).attr("selected",!0),!1})}})}$(document).ready(function(){registerTimeZoneEvents($("body")),objUtilities.RegisterEventHandlers.push(function(n){registerTimeZoneEvents(n)})});
function registerRedirectWithPostLink(n){n.find("a[data-type=postlink]").each(function(){var n=$(this),t=n.attr("data-href"),i=n.attr("data-parameters"),r=n.attr("target");n.click(function(){var u=i.split(";"),n=GetNewForm();jQuery.each(u,function(){var t=$(this)[0],i=t.indexOf("="),r,u;i>=0&&t.length>i&&(r=t.substring(0,i),u=t.substring(i+1,t.length),CreateHiddenField(n,r,u))}),n.target=r,n.action=t,n.submit()})})}function GetNewForm(){var n=document.createElement("FORM");return document.body.appendChild(n),n.method="POST",n}function CreateHiddenField(n,t,i){var r=document.createElement("input");return r.setAttribute("name",t),r.setAttribute("type","hidden"),r.value=i,n.appendChild(r),r}$(document).ready(function(){registerRedirectWithPostLink($("body")),objUtilities.RegisterEventHandlers.push(function(n){registerRedirectWithPostLink(n)})});
function utilities(){this.disableChildren=function(n){$("#"+n).length>0&&($("#"+n+" input").not("#"+n+" .preventdisabled input").attr("disabled","disabled"),$("#"+n+" button").not("#"+n+" .preventdisabled button").attr("disabled","disabled"),$("#"+n+" select").not("#"+n+" .preventdisabled select").attr("disabled","disabled"),$("#"+n+" a").not("#"+n+" .preventdisabled a").click(function(n){n.preventDefault()}))},this.enableChildren=function(n){$("#"+n).length>0&&($("#"+n+" input").removeAttr("disabled","disabled"),$("#"+n+" button").removeAttr("disabled","disabled"),$("#"+n+" select").removeAttr("disabled","disabled"),$("#"+n+" a").click(function(){}))},this.updateValidators=function(){$("form").removeData("validator"),$("form").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse("form")},this.RegisterEventHandlers=[],this.isSessionValid=!0,this.triggerSessionValidEvent=function(){this.isSessionValid&&$(document).trigger("sessionValid")},this.blockUI=function(){var n=$("#msgLoading").html();this.showLoading(n,"blockMsg")},this.showLoading=function(n,t){this.stopLoading();var i=$('<iframe id="loadingFrame" class="loadIndicator loadingIframe" style="" src="'+/^https/i.test(window.location.href||"")?"javascript:false":'about:blank"><\/iframe>'),r=$('<div class="loadIndicator blockOverlay"><\/div>'),u=$('<div class="loadIndicator '+t+'" role="alert" aria-busy="true">'+n+"<\/div>");$.browser.msie&&i.show(),$("body").append(i),$("body").append(r),$("body").append(u),r.fadeIn(200),u.focus(),i.bind("mousedown mouseup",null,function(){return!1}),$(this.getParent(parent)).scrollTop(0)},this.getParent=function(n){return n.parent==n?n:(n=n.parent,this.getParent(n))},this.stopLoading=function(){$("body").children().filter(".loadIndicator").add("body > .loadIndicator").each(function(){this.parentNode&&this.parentNode.removeChild(this)})},this.showSessionPanel=function(n){this.showLoading(n.find("#session_error_panel").html(),"blockMsg defaultcursor sessionTimeoutMsg")},this.loadJSFile=function(n,t){if(n&&n.length>0){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",n),t===!0?document.getElementsByTagName("head")[0].appendChild(i):document.body.appendChild(i)}},this.encodeUrl=function(i){var r,u,f;if(typeof i=="undefined")return"";for(i=i.toString(),u="",f=0;f<i.length;f++)r=i.charCodeAt(f),u=r>96&&r<123||r>64&&r<91||r>47&&r<58||r==46||r==45||r==95?u+String.fromCharCode(r):r>127?u+"%u"+t(r):u+"%"+n(r);return u};var n=function(n){for(var t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},t=function(n){for(var t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t};this.fetchCookieVal=function(n){for(var i,u,f=!1,r=document.cookie.split(";"),t=0;t<r.length;t++)if(i=r[t].substring(0,r[t].indexOf("=")),i.charAt(0)==" "&&(i=i.substring(1,i.length)),u=r[t].substring(r[t].indexOf("=")+1,r[t].length),n==i){f=!0;break}return f?u:"blank"},this.isMetro=function(){return!isActivexEnabled()&&this.getIEVersion()>-1},this.isActivexEnabled=function(){try{return!!new ActiveXObject("htmlfile")}catch(n){return!1}},this.getIEVersion=function(){var t=-1,i=navigator.userAgent,n;return navigator.appName=="Microsoft Internet Explorer"?(n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),n.exec(i)!=null&&(t=parseFloat(RegExp.$1))):navigator.appName=="Netscape"&&(n=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),n.exec(i)!=null&&(t=parseFloat(RegExp.$1))),t},this.isValidCidrIpAddress=function(n){var i,t,u;if(n==null)return!0;var f=n.replace(/(\r\n|\n|\r)/gm,""),r=f.split(";");if(r.length>0)for(i=0;i<r.length;i++)if(t=this.trimStr(r[i]).split("/"),t.length>0&&t.length<=2){if(!/^(([01]?\d\d?|2[0-4]\d|25[0-5])\.){3}([01]?\d\d?|25[0-5]|2[0-4]\d)$/.test(t[0]))return!1;if(t.length==2)if(/^\d+$/.test(t[1])){if(u=parseInt(t[1],10)||0,u<24||u>32)return!1}else return!1}else return!1;return!0},this.trimStr=function(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}var objUtilities=new utilities;
function postUtility(){this.redirect=function(){if(redirectWithPost){if(objUtilities&&!objUtilities.isSessionValid)return;n(redirectWithPost)}};var n=function(n){var i=top.document.createElement("form");n.RedirectInParent?top.document.body.appendChild(i):document.body.appendChild(i),t(n.Parameters,i),i.action=n.Target,i.method=n.Method,i.submit()},t=function(n,t){var r,i;if(n)for(r in n)i=top.document.createElement("input"),i.setAttribute("type","hidden"),i.setAttribute("name",r),i.setAttribute("id",r),i.setAttribute("value",n[r]),$(t).append(i)}}var objPostUtility=new postUtility;
function datePickerScripts(){function n(n){var f=n.id,e=f.lastIndexOf("_"),r="",t,i,u,c;if(e>0&&(r=f.substring(0,e),t=$("#"+r),i=$("#"+r+"_Error"),t&&t.length>0)){var o=$("#"+r+"_Days").val(),s=$("#"+r+"_Months").val(),h=$("#"+r+"_Years").val();o.toLowerCase()!="day"&&s.toLowerCase()!="month"&&h.toLowerCase()!="year"?(u=o+"/"+s+"/"+h,t.val(u),c=new RegExp(t.attr("data-val-regex-pattern")),c.test(u)?(t.val(u),i&&i.html()!=""&&(i.children("span:first").hide(),i.removeClass("field-validation-error"),i.addClass("field-validation-valid"))):i.children("span:first").html(t.attr("data-val-regex"))):(t.val(""),i.children("span:first").html(t.attr("data-val-required")))}}$(".DatePickerCombo").change(function(){n(this)}),$(".DatePickerCombo").bind("addAriaAttr",function(){var t=this.id.lastIndexOf("_"),n="";$("#"+this.id).attr("aria-labelledby")||t>0&&(n=this.id.substring(0,t),$("#"+this.id).attr("aria-labelledby",n+"_Label "+n+"_Error"))}),$(".DatePickerCombo").trigger("addAriaAttr")}var datePicker=new datePickerScripts;
function registerCIDRValidation(){$.validator.addMethod("cidrMethod",function(n,t){return n==null?!0:objUtilities.isValidCidrIpAddress(n)?!0:($("#"+t.id).attr("title",$("#"+t.id).attr("data-val-cidr")),!1)}),$("[data-val-cidr]").length>0&&$("[data-val-cidr]").each(function(){$(this).rules("add","cidrMethod")})}$(function(){registerCIDRValidation(),objUtilities.RegisterEventHandlers.push(registerCIDRValidation)});
function pcsiFrame(){this.apiCallCounter=0,this.pcsiFrameLoaded=!1,this.pcsiFrameTimoutID,this.mainFormHeight=0,this.PostMessageToPCS=function(n){var t=$("#pcsiFrame")[0].contentWindow;t.postMessage(n,"*")},this.Init=function(){window.addEventListener?window.addEventListener("message",pcsUtilities.OnPCSMessage,!1):window.attachEvent&&window.attachEvent("onmessage",pcsUtilities.OnPCSMessage),$("#Previous").click(function(){var n={Method:"Previous",Callback:"NextCallback",Parameter:"",Corelation:pcsUtilities.apiCallCounter++},t=JSON.stringify(n);objUtilities.blockUI(),pcsUtilities.PostMessageToPCS(t)}),$("#overlayContinue").click(function(){var n={Method:"Next",Callback:"NextCallback",Parameter:"",Corelation:pcsUtilities.apiCallCounter++},t=JSON.stringify(n);objUtilities.blockUI(),pcsUtilities.PostMessageToPCS(t)}),$("#close").click(function(){pcsUtilities.closePcsOverLay()}),$("#showOverlay").click(function(){pcsUtilities.showPCSiFrame()}),pcsUtilities.autoshowOverlay()&&(pcsUtilities.showPCSiFrame(),pcsUtilities.setAutoShowCookie("false"))},this.OnPCSMessage=function(n){var t="",f,i,s;if("domain"in n&&(t=n.domain),"origin"in n&&(t=n.origin),t=="https://buy.live-int.com"||t=="https://buy.live.com"){var r=n.data,u=$.parseJSON(n.data),e=u.type?u.type:"",o=$.parseJSON(u.data);r=r.replace(/\\/g,""),f=r.split(","),i="";for(s in f)i=i+f[s]+"\n";$("#PostMessageData").text(i),e=="message"?pcsUtilities.HandlePCSMessage(o):e=="api_return"&&pcsUtilities.HandlePCSAPIReturn(o)}},this.HandlePCSAPIReturn=function(n){pcsUtilities.PCSAPIReturnHandler[n.method]?pcsUtilities.PCSAPIReturnHandler[n.method](n):console&&console.log("callback method not found: "+n.method)},this.HandlePCSMessage=function(n){if(pcsUtilities.pcsiFrameLoaded=!0,pcsUtilities.iFrameLoadSuccess(),objUtilities.stopLoading(),n.method=="pcs_onerror")if(n.errorcode=="20"){pcsUtilities.setAutoShowCookie("show");var t=$(".signinRedirect").attr("href");t?window.parent.location=t:pcsUtilities.showErrorLoading()}else pcsUtilities.showErrorLoading(),console&&(console.log("PCS error: "+n.errorcode),console.log("PCS error message: "+n.errormsg));else n.method=="pcs_onheightchange"?($("#pcsiFrame").height(n.height+50),$("#innerOverlay").height($("#pcsiFrame").height()+$("#PostMessageData").height()+$("#overlayHeader").height()+100),$("#mainform").height($("#innerOverlay").height()+50)):n.method=="pcs_onsuccess"?(pcsUtilities.closePcsOverLay(),objUtilities.blockUI(),window.location.search=window.location.search+"&relaod=pcs"):n.method=="pcs_onnavigationrequired"?console&&console.log("pcs_onnavigationrequired message received: "+n.redirecturl):n.method=="pcs_onpagerenderednotify"&&($("#pcsiFrame").show(),n.errorcode&&n.errorcode!=""&&console&&console.log("server side error:"+n.errorcode))},this.iFrameLoadSuccess=function(){var n,t;!$("#pcsiFrameLoadSuccess","#mainform").length>0&&(n=document.createElement("div"),n.setAttribute("class","hide"),n.setAttribute("id","pcsiFrameLoadSuccess"),n.setAttribute("data-pcsiframesuccess","PCS iFrame loaded successfully"),n.innerText="PCS iFrame loaded successfully",t=document.getElementById("mainform"),t.appendChild(n))},this.PCSAPIReturnHandler={ValidateResult:function(n){console&&console.log(n.method+":"+n.Result)},NextCallback:function(n){console&&console.log(n.method+":"+n.Result),n.Result=="invalid"&&objUtilities.stopLoading()}},this.addiFrame=function(){var t=document.getElementById("iframeContainer"),n;t.setAttribute("width","100%"),!$("iframe","#iframeContainer").length>0&&(n=document.createElement("iframe"),n.src="about:blank",n.setAttribute("width","100%"),n.id="pcsiFrame",t.appendChild(n))},this.showPCSiFrame=function(){pcsUtilities.pcsiFrameLoaded=!1,pcsUtilities.mainFormHeight=$("#container").height(),pcsUtilities.hideErrorLoading(),objUtilities.blockUI(),pcsUtilities.addiFrame();var n=$("#iframeURL").text();console&&console.log("iframe URL: "+n),$("#pcsiFrame").attr("src",n),$("#pcsiFrame").show(),document.getElementById("overlay").style.visibility="visible",pcsUtilities.pcsiFrameTimoutID=setTimeout(function(){pcsUtilities.pcsiFrameLoaded?pcsUtilities.hideErrorLoading():pcsUtilities.showErrorLoading()},6e4)},this.showErrorLoading=function(){var n,t,u,i,r,f;objUtilities.stopLoading(),pcsUtilities.closePcsOverLay(),$("#errorLoading").removeClass("hide"),!$("#pcsiframeloggingdiv","#mainform").length>0&&(n=document.createElement("div"),n.setAttribute("class","hide"),n.setAttribute("id","pcsiframeloggingdiv"),t=$("#pcsiFrameLogging").text(),t?(n.setAttribute("data-pcsiframeerror",t),n.innerText=t):(n.setAttribute("data-pcsiframeerror","Error loading PCS iFrame"),n.innerText="Error loading PCS iFrame"),u=document.getElementById("mainform"),u.appendChild(n)),i=$(".signinRedirect").attr("href"),i||(i="Sign-in URL missing"),r=$("#iframeURL").text(),r||(r="iFrame URL missing"),f=$("#aiurl")[0].innerHTML;try{$.ajax({type:"GET",cache:"false",url:f,data:{key:"pcsiFrameError",properties:r+","+i},dataType:"text",success:function(){}})}catch(e){}},this.hideErrorLoading=function(){$("#errorLoading").hasClass("hide")||$("#errorLoading").addClass("hide")},this.removeiFrame=function(){var n=document.getElementById("iframeContainer"),t=document.getElementById("pcsiFrame");n.removeChild(t)},this.closePcsOverLay=function(){document.getElementById("overlay").style.visibility="hidden",pcsUtilities.removeiFrame(),pcsUtilities.mainFormHeight!=0&&$("#mainform").height(pcsUtilities.mainFormHeight),typeof pcsUtilities.pcsiFrameTimoutID=="number"&&clearTimeout(pcsUtilities.pcsiFrameTimoutID)},this.autoshowOverlay=function(){return objUtilities.fetchCookieVal("pcsoverlay")=="show"?!0:!1},this.setAutoShowCookie=function(n){document.cookie="pcsoverlay="+n}}"JSON"in window&&window.JSON||(JSON={}),function(){function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var c,l,s,a,v=n,h,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i)),typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,h=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,c=0;c<a;c+=1)h[c]=u(c,e)||"null";return s=h.length===0?"[]":n?"[\n"+n+h.join(",\n"+n)+"\n"+v+"]":"["+h.join(",")+"]",n=v,s}if(t&&typeof t=="object")for(a=t.length,c=0;c<a;c+=1)l=t[c],typeof l=="string"&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));else for(l in e)Object.hasOwnProperty.call(e,l)&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));return s=h.length===0?"{}":n?"{\n"+n+h.join(",\n"+n)+"\n"+v+"}":"{"+h.join(",")+"}",n=v,s}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})}),typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(f.lastIndex=0,f.test(n)&&(n=n.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();var pcsUtilities=new pcsiFrame;
