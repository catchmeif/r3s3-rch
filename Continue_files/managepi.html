<!DOCTYPE html>
<!-- saved from url=(0192)https://buy.live.com/PCSV2/msstore/liverps/pcs/managepi?oem=getsupport&PIType=1&usertype=business&mkt=en-us&adcs=1&correlationid=a35a6e03-9d67-4b19-9a3b-2354518a22bb&ctprpsauth=1&wa=wsignin1.0 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<noscript>
    &lt;meta http-equiv="REFRESH" content="0;URL='/PCSV2/Default/liverps/Error/DefinedError?errorCode=9032'" /&gt;
</noscript>
<meta http-equiv="X-UA-Compatible" content="IE=10"><title>Payment Information Collection Service</title>
    <link href="./style.css" rel="stylesheet" type="text/css">
    <link href="./style(1).css" rel="stylesheet" type="text/css">
    <link href="./style(2).css" rel="stylesheet" type="text/css">

</head>
<body tabindex="-1">
    <div id="mainContent">
        

<script type="text/javascript">
setTimeout(function(){$('#pageUnloadInitiator').val("sessionExpire");document.location=unescape('%2fPCSv2%2fmsstore%2fliverps%2fPCS%2fSessionExpire%3fmkt%3den-us%26lmkt%3den-us%26rx%3d%26entryurl%3dhttps%253a%252f%252fbuy.live.com%253a443%252fPCSV2%252fmsstore%252fliverps%252fpcs%252fmanagepi%253foem%253dgetsupport%2526PIType%253d1%2526usertype%253dbusiness%2526mkt%253den-us%2526adcs%253d1%2526correlationid%253da35a6e03-9d67-4b19-9a3b-2354518a22bb%2526ctprpsauth%253d1%2526wa%253dwsignin1.0%26correlationid%3da35a6e03-9d67-4b19-9a3b-2354518a22bb');}, 3480000);
</script>

<form action="https://buy.live.com/PCSV2/msstore/liverps/PCS/DoNext?mkt=en-us&amp;lmkt=en-US" id="PCSBodyForm" method="post" novalidate="novalidate">    <div id="PageContainer" class="page-container hidden" style="display: block;">
        <div class="page-content">
            <div class="error-sys-top hidden" id="cc_expiredmsg">Your credit card has expired. Please select an expiration date in the future.</div>
            <div class="error-sys-top" id="tokenizationError" style="display:none">Something has gone wrong, please try again later</div>
            <div class="error-sys-top hidden" id="ToUpdateIE">Your browser's version is not up to date. Please update it to a more recent one.</div>
            <div id="selectCountryDiv">
                


            </div>
            <div id="ChoosePITitle" class="title1 font-section-title">
    <img id="ChoosePIArrowImage" src="./arrow-expanded.png">
    <h3 id="lblChoosePaymentMethod" class="accessibilityread" role="heading" title="Choose a payment method">Choose a payment method</h3>
    <div id="LogoImages" class="logo">
</div>

</div>

<div id="PIList" class="payment-method">

<ul class="new-pi">
    <li class="title accessibilityread" id="lblNewPaymentMethod" tabindex="-1">New payment method</li>
        <li>
            <input cardtype="cc" category="new" id="$newcc" name="pcs_spiid" title="Credit/Debit card" type="radio" value="$newcc" checked="checked">
            <label for="$newcc" id="lblNewCreditCard" title="Credit/Debit card">Credit/Debit card</label></li>
</ul>
    <div id="ExistingPI" class="exist-pi">

        <div class="clear">
        </div>
    </div>
    <div class="clear">
    </div>    
</div>
            <div class="clear">
            </div>
<div id="PIDetailTitle" class="title2 font-section-title">
    









        
    

<div id="ccPIDetailTitle">
    <img id="PIDetailArrowImage" src="./arrow-expanded.png">
    <h3 id="ccStep2Title">
        Add payment information </h3>
</div></div>
            <div id="PIInfo" class="card-info">
                <div id="pi-card">
    

 

 
           
                <div id="newcc">
        <div class="info-left">
                       
<div class="cell width-cell-creditcardtype">
        <h4 id="lblCreditCardType"><span class="title-append">*</span>Card type</h4>
    
    <div class="content creditcardtype-selector">
            <div id="CreditCardTypeList" class="creditcardtype-radio">
                            <label><input type="radio" id="creditCardType" name="creditCardType" value="VISA" title="Visa, 1 of 4 Items" checked="checked"><img src="./IconCardType_visa.png" alt="Visa, 1 of 4 Items" title="Visa, 1 of 4 Items"></label>
                            <label><input type="radio" id="creditCardType" name="creditCardType" value="MC" title="MasterCard, 2 of 4 Items"><img src="./IconCardType_mastercard.png" alt="MasterCard, 2 of 4 Items" title="MasterCard, 2 of 4 Items"></label>
                            <label><input type="radio" id="creditCardType" name="creditCardType" value="AMEX" title="American Express, 3 of 4 Items"><img src="./IconCardType_amex.png" alt="American Express, 3 of 4 Items" title="American Express, 3 of 4 Items"></label>
                            <label><input type="radio" id="creditCardType" name="creditCardType" value="DISCOVER" title="Discover Network, 4 of 4 Items"><img src="./IconCardType_discover.png" alt="Discover Network, 4 of 4 Items" title="Discover Network, 4 of 4 Items"></label>
            </div>
    </div>
</div>


            
<div class="cell width-cell" id="wrapperCreditCardNumber"><h4 id="lblCreditCardNumber"><span class="title-append">*</span>Card number</h4>
<div class="content">
    <div class="relative">
        <input autocomplete="off" class="input1 width-input" id="creditCardNumber" name="creditCardNumber" title="Card number" type="text" value="" maxlength="16" style="background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABHklEQVQ4EaVTO26DQBD1ohQWaS2lg9JybZ+AK7hNwx2oIoVf4UPQ0Lj1FdKktevIpel8AKNUkDcWMxpgSaIEaTVv3sx7uztiTdu2s/98DywOw3Dued4Who/M2aIx5lZV1aEsy0+qiwHELyi+Ytl0PQ69SxAxkWIA4RMRTdNsKE59juMcuZd6xIAFeZ6fGCdJ8kY4y7KAuTRNGd7jyEBXsdOPE3a0QGPsniOnnYMO67LgSQN9T41F2QGrQRRFCwyzoIF2qyBuKKbcOgPXdVeY9rMWgNsjf9ccYesJhk3f5dYT1HX9gR0LLQR30TnjkUEcx2uIuS4RnI+aj6sJR0AM8AaumPaM/rRehyWhXqbFAA9kh3/8/NvHxAYGAsZ/il8IalkCLBfNVAAAAABJRU5ErkJggg==&quot;); background-repeat: no-repeat; background-attachment: scroll; background-size: 16px 18px; background-position: 98% 50%; cursor: auto;">
            <div class="hint width-input accessibilityread" id="lblCreditCardNumberHint" role="tooltip">- Enter without dashes or spaces -</div>
    </div>
</div>

</div>
            <div class="cell width-cell-expirationdate marg-rig-expirationdate" id="expirationDateDiv">
    <h4 id="lblCreditCardExpirationDate"><span class="title-append">*</span>Expiration date</h4>
    <div class="content">
        <div>
            <select aria-label="Expiration month" class="width-input-expirationdateMM" id="creditCardExpireMonth" name="creditCardExpireMonth" title="Month"><option selected="selected" value="">MM</option>
<option value="1">01</option>
<option value="2">02</option>
<option value="3">03</option>
<option value="4">04</option>
<option value="5">05</option>
<option value="6">06</option>
<option value="7">07</option>
<option value="8">08</option>
<option value="9">09</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
</select><span class="space-span width-space-expirationdate"></span><select aria-label="Expiration year" class="width-input-expirationdateYY" id="creditCardExpireYear" name="creditCardExpireYear" title="Year"><option selected="selected" value="">YYYY</option>
<option value="2017">2017</option>
<option value="2018">2018</option>
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
<option value="2037">2037</option>
<option value="2038">2038</option>
<option value="2039">2039</option>
<option value="2040">2040</option>
<option value="2041">2041</option>
<option value="2042">2042</option>
</select>
        </div>
    </div>
</div>

            <div class="clear">
            </div>
        </div>
        <div class="info-right">
            
<div class="cell width-cell" id="creditCardHolderNameDiv"><h4 id="lblCreditCardHolderName"><span class="title-append">*</span>Name on card</h4>
<div class="content">
    <div>
        <input autocomplete="off" class="input1 width-input" id="creditCardHolderName" name="creditCardHolderName" title="Name on card" type="text" value="" maxlength="64">
    </div>
</div>

</div>
            <div class="cell width-full ">
                <h4 id="lblCreditCardCvm"><span class="title-append">*</span>CVV
                </h4>
                <div class="content">
                    <div>
                    <input autocomplete="off" class="input1 width-input-cvv" id="cvm" name="cvm" title="CVV" type="text" value="" maxlength="4">
                        <span title="The CVV Number (&quot;Card Verification Value&quot;) on your credit card or debit card is a 3 digit number found at the end of the credit card number on the back of VISA®, MasterCard® and Discover® branded credit and debit cards. On your American Express® branded credit or debit card it is a 4 digit number found on the front of the card to the right and above the credit card number.">
                        <a href="https://buy.live.com/PCSV2/msstore/liverps/pcs/managepi?oem=getsupport&amp;PIType=1&amp;usertype=business&amp;mkt=en-us&amp;adcs=1&amp;correlationid=a35a6e03-9d67-4b19-9a3b-2354518a22bb&amp;ctprpsauth=1&amp;wa=wsignin1.0#" id="WhatsThis" class="font-link1 Whatsthis link">What's this?</a></span>
<div class="tooltip" id="tooltip" style="margin-left: 0px;">
    <div class="tooltip-left">
        <img src="./CVV_transparent_answerdesk.png" alt="CVV">
    </div>
    <div class="tooltip-right">
        <div class="halfHeight">
            <li class="toolTipTextTop" id="lblCreditCardToolTipOne">
                3 digit verification code
            </li>
        </div>
        <div class="halfHeight">
            <li class="toolTipTextBottom" id="lblCreditCardToolTipTwo">
                4 digit verification code
            </li>
        </div>
    </div>
</div>
                    </div>
                </div>
            </div>
            

            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div></div>
                <div id="pi-addr">
                 <div id="edaddr">
    <h3 class="title-address font-sub-title" id="lblBillingAddress">Billing address</h3>
        <div class="info-left">
    <div class="cell width-cell">
        <h4 id="lblBillingAddressLine1"><span class="title-append">*</span>Friendly name</h4>
        <div class="content">
            <div><input autocomplete="off" class="input1 width-input" id="addressFriendlyName" name="addressFriendlyName" title="Friendly name" type="text" value="" maxlength="64"></div>
        </div>
    </div>
                <div class="cell width-cell">
        
<h4 id="lblBillingAddressLine1"><span class="title-append">*</span>Address line 1</h4>
<div class="content">
    <div>
        <input autocomplete="off" class="input1 width-input" id="billingAddress1" name="billingAddress1" title="Address line 1" type="text" value="" maxlength="128">
    </div>
</div>


    </div>

                <div class="cell width-full">
        
<h4 id="lblBillingAddress2">Address line 2</h4>
<div class="content">
    <div class="relative">
        <input autocomplete="off" class="input1 width-input" id="billingAddress2" name="billingAddress2" title="Address line 2" type="text" value="" maxlength="128">
            <div class="hint width-input accessibilityread" id="lblBillingAddress2Hint" role="tooltip">- Optional -</div>
    </div>
</div>


    </div>

                <div class="cell width-cell">
        
<h4 id="lblBillingCity"><span class="title-append">*</span>City</h4>
<div class="content">
    <div>
        <input autocomplete="off" class="input1 width-input" id="billingCity" name="billingCity" title="City" type="text" value="" maxlength="26">
    </div>
</div>


    </div> 

                <div class="cell marg-rig-cell-half width-state width-cell-half">
        <h4 id="lblBillingState"><span class="title-append">*</span>State</h4>
        <div class="content">
            <div class="styled-select"><select class="width-input-state" id="billingState" name="billingState" title="State" maxlength="64"><option selected="selected" value=""></option>
<option value="AA">AA</option>
<option value="AE">AE</option>
<option value="AK">AK</option>
<option value="AL">AL</option>
<option value="AP">AP</option>
<option value="AR">AR</option>
<option value="AS">AS</option>
<option value="AZ">AZ</option>
<option value="CA">CA</option>
<option value="CO">CO</option>
<option value="CT">CT</option>
<option value="DC">DC</option>
<option value="DE">DE</option>
<option value="FL">FL</option>
<option value="GA">GA</option>
<option value="GU">GU</option>
<option value="HI">HI</option>
<option value="IA">IA</option>
<option value="ID">ID</option>
<option value="IL">IL</option>
<option value="IN">IN</option>
<option value="KS">KS</option>
<option value="KY">KY</option>
<option value="LA">LA</option>
<option value="MA">MA</option>
<option value="MD">MD</option>
<option value="ME">ME</option>
<option value="MI">MI</option>
<option value="MN">MN</option>
<option value="MO">MO</option>
<option value="MS">MS</option>
<option value="MT">MT</option>
<option value="NC">NC</option>
<option value="ND">ND</option>
<option value="NE">NE</option>
<option value="NH">NH</option>
<option value="NJ">NJ</option>
<option value="NM">NM</option>
<option value="NV">NV</option>
<option value="NY">NY</option>
<option value="OH">OH</option>
<option value="OK">OK</option>
<option value="OR">OR</option>
<option value="PA">PA</option>
<option value="PR">PR</option>
<option value="PW">PW</option>
<option value="RI">RI</option>
<option value="SC">SC</option>
<option value="SD">SD</option>
<option value="TN">TN</option>
<option value="TX">TX</option>
<option value="UT">UT</option>
<option value="VA">VA</option>
<option value="VI">VI</option>
<option value="VT">VT</option>
<option value="WA">WA</option>
<option value="WI">WI</option>
<option value="WV">WV</option>
<option value="WY">WY</option>
</select></div>
        </div>
    </div>

                <div class="cell width-zipcode width-cell-half">
        <h4 id="lblBillingZipCode"><span class="title-append">*</span>ZIP code</h4>
        <div class="content">
            <div class="relative">
                <input autocomplete="off" class="input1 width-input-zipcode" id="billingZipcode" name="billingZipcode" title="ZIP code" type="text" value="" maxlength="10">
                <div class="hint width-input-zipcode accessibilityread" id="lblBillingZipCodeHint" role="tooltip">
                    - Example: 97531 -
                </div>
            </div>
        </div>
    </div>    

            <div class="clear"></div>
                <div class="cell width-full">
        <h4 class="accessibilityread" id="lblBillingCountry" tabindex="-1">Country/region</h4>
        <div class="content">
            <div class="countryname  accessibilityread" tabindex="-1">United States
</div>
        </div>
    </div>  

            <div class="clear"></div>
        </div>
        <div class="info-right">
                <div class="cell width-full">
        <h4 id="lblBillingPhone"><span class="title-append">*</span>Phone number</h4>
        <div class="content" id="phonenumberRTL">
            <div class="relative">
                <input aria-label="Phone number area code" autocomplete="off" class="input1 width-phone2-prefix-ext inputRTL" id="billingPhonePrefix" name="billingPhonePrefix" title="- Area Code -" type="text" value="" maxlength="3"><span class="space-span width-space-phone"> <label>-</label> </span><input aria-label="Phone number" autocomplete="off" class="input1 width-phone2-number inputRTL" id="billingPhoneNumber" name="billingPhoneNumber" title="- Number -" type="text" value="" maxlength="25">
                <div class="hint width-phone2-prefix-ext" forid="billingPhonePrefix" id="lblBillingPhonePrefixHint">- Area Code -</div>
                <div class="hint width-phone2-number left-phone2-number" forid="billingPhoneNumber" id="lblBillingPhoneNumberHint">- Number -</div>
            </div>
        </div>
    </div>


            <div class="clear"></div>
        </div>
    <div class="clear">
    </div>
</div></div>
                <div id="pi-sepa">
                </div>
            </div>
    <div id="pi-extra" class="hidden" style="display: block;">
<div class="title3 font-section-title"><img id="RequiredDetailArrowImage" src="./arrow-expanded.png">
<h3 class="accessibilityread" role="heading">Add additional details</h3>
</div>
            <div id="AccountDetailInfo">
                
                
                

                
            <div id="UserDetailForPayin">
    <div class="info-left">
        <div class="cell width-cell">
    <h4 id="lblBillingCompanyName">Company name</h4>
    <div class="content">
        <div class="relative">
            <input autocomplete="off" class="input1 width-input" id="CompanyName" name="CompanyName" title="Company name" type="text" value="" maxlength="64">
            <div class="hint" id="lblBillingCompanyNameHint">- Optional -</div>
        </div>
    </div>
</div>

        
        <div class="clear"></div>
    </div>
    <div class="info-right">
        <div id="accountEmailLabel" class="cell width-cell">
    
<h4 id="lblBillingEmail"><span class="title-append">*</span>Email</h4>
<div class="content">
    <div>
        <input autocomplete="off" class="input1 width-input" id="billingEmail" name="billingEmail" title="Email" type="text" value="" maxlength="129">
    </div>
</div>


</div>

        <div class="clear"></div>
    </div>
    <div class="clear"></div>
</div></div>
    </div>
            <div class="clear">
            </div>
            
                <div id="PIInfoReview" style="display: none;">
                    <div id="DDReview" class="hidden review" style="display: none;">
<h3 class="font-sub-title title-review">Review and sign agreement</h3>
<div>By having signed into your Windows Live account and clicking <b>Next</b> below, you agree to the <a class="font-link1" href="https://cashbackaccount.bing.com/CashBack/Tou.aspx" target="_blank">Authorization agreement</a>.</div>
</div>
                    <div id="PPReview" class="hidden review" style="display: none;">
<h3 class="font-sub-title title-review">Review and sign agreement</h3>
    <div><p>We are collecting your PayPal email address so that PayPal can process your payment. We retain a copy of that information so that we can provide your payout to PayPal. For more information about how we use and protect your personal information, please click on the link below to our Privacy Statement.</p></div>
</div>
                </div>
            
            
            
        </div>
        
        <div class="page-foot" id="pagefooter">
            <div class="clear">
            </div>
                   <div id="piNote">
            
<div id="newccnote" class="btnNote"><p>When you add a credit card as a payment method, Microsoft authorizes the card by making a small, temporary charge to your account. You won’t pay anything until you buy something from the Store.
<br>
Your credit card company might charge an International Transaction Fee (ITF) or a currency conversion charge when you buy something from the Store.</p></div></div><input id="cancelURL" name="cancelURL" type="hidden" value="/PCSV2/msstore/liverps/pcs/DoCancel">

       
       <div class="clear"></div>
       <div class="privacy accessibilityread" id="lblPrivacy" role="tooltip">
Microsoft is committed to helping protect your privacy. For more info, see our <a class="font-link1" href="http://go.microsoft.com/fwlink/?LinkId=248681" id="privacyString" target="_blank">privacy and cookies</a>.</div>
            <div class="clear">
            </div>
        </div>
    </div>    
<div id="dataValidate" style="display: none;">
        <div class="label middle" id="addressFriendlyNameSimpleValidator">
            <span id="addressFriendlyNamePatternMsg">Contains invalid characters.</span>
            <span id="addressFriendlyNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="creditCardTypeSimpleValidator">
            <span id="creditCardTypePatternMsg">Invalid credit card type.</span>
            <span id="creditCardTypePatternValue">.*</span>
        </div>
        <div class="label middle" id="creditCardNumberSimpleValidator">
            <span id="creditCardNumberPatternMsg">Invalid credit card number.</span>
            <span id="creditCardNumberPatternValue">^[0-9]{13,16}$</span>
        </div>
        <div class="label middle" id="creditCardExpireMonthSimpleValidator">
            <span id="creditCardExpireMonthPatternMsg">This is not a valid expiration month.</span>
            <span id="creditCardExpireMonthPatternValue">^((0?[1-9])|(1[0-2]))$</span>
        </div>
        <div class="label middle" id="creditCardExpireYearSimpleValidator">
            <span id="creditCardExpireYearPatternMsg">This is not a valid expiration year.</span>
            <span id="creditCardExpireYearPatternValue">^[0-9]{4}$</span>
        </div>
        <div class="label middle" id="cvmSimpleValidator">
            <span id="cvmPatternMsg">Invalid verification code.</span>
            <span id="cvmPatternValue">^[0-9]{3,4}$</span>
        </div>
        <div class="label middle" id="directDebitNumberSimpleValidator">
            <span id="directDebitNumberPatternMsg">Invalid account number.</span>
            <span id="directDebitNumberPatternValue">^[0-9\-]{4,17}$</span>
        </div>
        <div class="label middle" id="directDebitNumberConfirmSimpleValidator">
            <span id="directDebitNumberConfirmPatternMsg">Invalid account number confirmation.</span>
            <span id="directDebitNumberConfirmPatternValue">^[0-9\-]{4,17}$</span>
        </div>
        <div class="label middle" id="directDebitBankCodeSimpleValidator">
            <span id="directDebitBankCodePatternMsg">Invalid routing number.</span>
            <span id="directDebitBankCodePatternValue">^[0-9]{9}$</span>
        </div>
        <div class="label middle" id="payPalFirstNameSimpleValidator">
            <span id="payPalFirstNamePatternMsg">Invalid first name.</span>
            <span id="payPalFirstNamePatternValue">.*</span>
        </div>
        <div class="label middle" id="payPalLastNameSimpleValidator">
            <span id="payPalLastNamePatternMsg">Invalid last name.</span>
            <span id="payPalLastNamePatternValue">.*</span>
        </div>
        <div class="label middle" id="payPalEmailSimpleValidator">
            <span id="payPalEmailPatternMsg">Invalid PayPal email address.</span>
            <span id="payPalEmailPatternValue">^[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$</span>
        </div>
        <div class="label middle" id="amazonFPSEmailSimpleValidator">
            <span id="amazonFPSEmailPatternMsg"></span>
            <span id="amazonFPSEmailPatternValue">^[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$</span>
        </div>
        <div class="label middle" id="FirstNameSimpleValidator">
            <span id="FirstNamePatternMsg">Contains invalid characters.</span>
            <span id="FirstNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="FirstNamePronunciationSimpleValidator">
            <span id="FirstNamePronunciationPatternMsg">Contains invalid characters.</span>
            <span id="FirstNamePronunciationPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="LastNameSimpleValidator">
            <span id="LastNamePatternMsg">Contains invalid characters.</span>
            <span id="LastNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="LastNamePronunciationSimpleValidator">
            <span id="LastNamePronunciationPatternMsg">Contains invalid characters.</span>
            <span id="LastNamePronunciationPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="CompanyNameSimpleValidator">
            <span id="CompanyNamePatternMsg">Contains invalid characters.</span>
            <span id="CompanyNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="VATIDSimpleValidator">
            <span id="VATIDPatternMsg">Invalid company VAT ID.</span>
            <span id="VATIDPatternValue">.*</span>
        </div>
        <div class="label middle" id="CommunicationEmailSimpleValidator">
            <span id="CommunicationEmailPatternMsg">Invalid email address.</span>
            <span id="CommunicationEmailPatternValue">^[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$</span>
        </div>
        <div class="label middle" id="billingAddress1SimpleValidator">
            <span id="billingAddress1PatternMsg">Contains invalid characters.</span>
            <span id="billingAddress1PatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingAddress2SimpleValidator">
            <span id="billingAddress2PatternMsg">Contains invalid characters.</span>
            <span id="billingAddress2PatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingAddress3SimpleValidator">
            <span id="billingAddress3PatternMsg">Contains invalid characters.</span>
            <span id="billingAddress3PatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingCitySimpleValidator">
            <span id="billingCityPatternMsg">Contains invalid characters.</span>
            <span id="billingCityPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="shippingCitySimpleValidator">
            <span id="shippingCityPatternMsg">Contains invalid characters.</span>
            <span id="shippingCityPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingStateSimpleValidator">
            <span id="billingStatePatternMsg">Contains invalid characters.</span>
            <span id="billingStatePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="shippingStateSimpleValidator">
            <span id="shippingStatePatternMsg">Contains invalid characters.</span>
            <span id="shippingStatePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingDistrictSimpleValidator">
            <span id="billingDistrictPatternMsg">Contains invalid characters.</span>
            <span id="billingDistrictPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="billingZipcodeSimpleValidator">
            <span id="billingZipcodePatternMsg">Invalid ZIP code.</span>
            <span id="billingZipcodePatternValue">^[0-9]{5}(-[0-9]{4})?$</span>
        </div>
        <div class="label middle" id="shippingZipcodeSimpleValidator">
            <span id="shippingZipcodePatternMsg">Invalid postal code.</span>
            <span id="shippingZipcodePatternValue">^[0-9]{5}(-[0-9]{4})?$</span>
        </div>
        <div class="label middle" id="billingPhonePrefixSimpleValidator">
            <span id="billingPhonePrefixPatternMsg">Invalid phone area code.</span>
            <span id="billingPhonePrefixPatternValue">^[0-9]{0,3}$</span>
        </div>
        <div class="label middle" id="shippingPhonePrefixSimpleValidator">
            <span id="shippingPhonePrefixPatternMsg">Invalid phone prefix.</span>
            <span id="shippingPhonePrefixPatternValue">^[0-9]{0,6}$</span>
        </div>
        <div class="label middle" id="billingPhoneNumberSimpleValidator">
            <span id="billingPhoneNumberPatternMsg">Invalid phone number.</span>
            <span id="billingPhoneNumberPatternValue">^[0-9\.\,\-\s]{1,25}$</span>
        </div>
        <div class="label middle" id="shippingPhoneNumberSimpleValidator">
            <span id="shippingPhoneNumberPatternMsg">Invalid phone number.</span>
            <span id="shippingPhoneNumberPatternValue">^[0-9\.\,\-\s]{0,25}$</span>
        </div>
        <div class="label middle" id="inicisPayBuyerFirstNameSimpleValidator">
            <span id="inicisPayBuyerFirstNamePatternMsg">Invalid first name.</span>
            <span id="inicisPayBuyerFirstNamePatternValue">.*</span>
        </div>
        <div class="label middle" id="inicisPayBuyerLastNameSimpleValidator">
            <span id="inicisPayBuyerLastNamePatternMsg">Invalid last name.</span>
            <span id="inicisPayBuyerLastNamePatternValue">.*</span>
        </div>
        <div class="label middle" id="inicisPayDescriptionSimpleValidator">
            <span id="inicisPayDescriptionPatternMsg">Invalid description.</span>
            <span id="inicisPayDescriptionPatternValue">.*</span>
        </div>
        <div class="label middle" id="inicisPayBuyerTelephonePhonePrefixSimpleValidator">
            <span id="inicisPayBuyerTelephonePhonePrefixPatternMsg">Invalid phone prefix.</span>
            <span id="inicisPayBuyerTelephonePhonePrefixPatternValue">^([0-9]{2,3})?$</span>
        </div>
        <div class="label middle" id="inicisPayBuyerTelephonePhoneNumberSimpleValidator">
            <span id="inicisPayBuyerTelephonePhoneNumberPatternMsg">Invalid phone number.</span>
            <span id="inicisPayBuyerTelephonePhoneNumberPatternValue">^(([0-9]{3,4}-[0-9]{4})|[0-9]{7,8})?$</span>
        </div>
        <div class="label middle" id="inicisPayBuyerTelephonePhoneExtensionSimpleValidator">
            <span id="inicisPayBuyerTelephonePhoneExtensionPatternMsg">Invalid phone extension.</span>
            <span id="inicisPayBuyerTelephonePhoneExtensionPatternValue">^([0-9]{2,4})?$</span>
        </div>
        <div class="label middle" id="inicisPayBuyerEMailSimpleValidator">
            <span id="inicisPayBuyerEMailPatternMsg">Invalid email address.</span>
            <span id="inicisPayBuyerEMailPatternValue">^[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$</span>
        </div>
        <div class="label middle" id="bankAccountPayHolderNameSimpleValidator">
            <span id="bankAccountPayHolderNamePatternMsg">Invalid name on account.</span>
            <span id="bankAccountPayHolderNamePatternValue">.*</span>
        </div>
        <div class="label middle" id="bankAccountPayNumberSimpleValidator">
            <span id="bankAccountPayNumberPatternMsg">Invalid account number.</span>
            <span id="bankAccountPayNumberPatternValue">^[0-9A-Za-z\-]{4,34}$</span>
        </div>
        <div class="label middle" id="bankAccountPayNumberConfirmSimpleValidator">
            <span id="bankAccountPayNumberConfirmPatternMsg">Invalid account number confirmation.</span>
            <span id="bankAccountPayNumberConfirmPatternValue">^[0-9A-Za-z\-]{4,34}$</span>
        </div>
        <div class="label middle" id="bankAccountPayBankCodeSimpleValidator">
            <span id="bankAccountPayBankCodePatternMsg">Invalid routing number.</span>
            <span id="bankAccountPayBankCodePatternValue">^[0-9]{9}$</span>
        </div>
        <div class="label middle" id="billingCurrencySimpleValidator">
            <span id="billingCurrencyPatternMsg">Invalid account currency.</span>
            <span id="billingCurrencyPatternValue">.*</span>
        </div>
        <div class="label middle" id="billingEmailSimpleValidator">
            <span id="billingEmailPatternMsg">Invalid account email.</span>
            <span id="billingEmailPatternValue">^[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$</span>
        </div>
        <div class="label middle" id="PicvAmountSimpleValidator">
            <span id="PicvAmountPatternMsg">Input invalid.</span>
            <span id="PicvAmountPatternValue">^[0-9]+([\.\,][0-9]+)?$|^[\.\,][0-9]+$</span>
        </div>
        <div class="label middle" id="PicvCodeSimpleValidator">
            <span id="PicvCodePatternMsg">Input invalid. It should be a 3-digit number.</span>
            <span id="PicvCodePatternValue">^[0-9]{3}$</span>
        </div>
        <div class="label middle" id="CountryCodeSimpleValidator">
            <span id="CountryCodePatternMsg">Invalid country/region code.</span>
            <span id="CountryCodePatternValue">^[0-9]+$</span>
        </div>
        <div class="label middle" id="PhoneNumberSimpleValidator">
            <span id="PhoneNumberPatternMsg">Invalid phone number.</span>
            <span id="PhoneNumberPatternValue">^[0-9]+$</span>
        </div>
        <div class="label middle" id="VerificationCodeSimpleValidator">
            <span id="VerificationCodePatternMsg">Invalid verification code.</span>
            <span id="VerificationCodePatternValue">^[0-9]+$</span>
        </div>
        <div class="label middle" id="ssnSimpleValidator">
            <span id="ssnPatternMsg">Invalid social security number.</span>
            <span id="ssnPatternValue">^([0-9]{9})$|([0-9]{3}-[0-9]{2}-[0-9]{4})$</span>
        </div>
        <div class="label middle" id="SSNFirstNameSimpleValidator">
            <span id="SSNFirstNamePatternMsg">Contains invalid characters.</span>
            <span id="SSNFirstNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="SSNLastNameSimpleValidator">
            <span id="SSNLastNamePatternMsg">Contains invalid characters.</span>
            <span id="SSNLastNamePatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="commentsSimpleValidator">
            <span id="commentsPatternMsg">Contains invalid characters.</span>
            <span id="commentsPatternValue">^[\u0009\u000A\u000D\u0020-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*$</span>
        </div>
        <div class="label middle" id="optionalTaxIDSimpleValidator">
            <span id="optionalTaxIDPatternMsg"></span>
            <span id="optionalTaxIDPatternValue">.*</span>
        </div>
        <div class="label middle" id="yearOfBirthdaySimpleValidator">
            <span id="yearOfBirthdayPatternMsg">Birthday is invalid.</span>
            <span id="yearOfBirthdayPatternValue">^19[0-9][0-9]|20[0-9][0-9]$</span>
        </div>
</div>
<input name="__RequestVerificationToken" type="hidden" value="XjjQLhYC7/dMEkqysyMWNkvYyzQztKOOQzmLUXH3UI6YZiIQ9hBri/Y++QiQpuACbjvnDWRuifC/Bk4o5wsGo7gbeANQsexYdNSKutZ2Ypi/B2sFCGpbbh3CGxshsOJtK9XrjPT8znOCvjX7giocAnSltOfPDqBBRJq7E32AF1zljVSU">    <input type="hidden" id="HasChangeOnUI" name="HasChangeOnUI" value="false">  
    <input type="hidden" id="selected-pi-type" name="pcs_spitp" value="cc">
    <input type="hidden" id="selected-pi-subtype" name="pcs_spisubtype" value="">
    <input type="hidden" id="NeedHandleAccountIDAndPIID" name="NeedHandleAccountIDAndPIID" value="True">
    <input type="hidden" id="piid" name="piid" value="$fvo">
    <input type="hidden" id="tenantId" name="tenantId" value="">
<input id="isSEPA" name="isSEPA" type="hidden" value="False">    <input type="hidden" id="selected-pi-category" value="new">  

<div id="telemetryData">
    <input type="hidden" id="sessionGuid" name="sessionGuid" value="1831ce5f-43cb-491c-813b-92d028269cff">
    <input type="hidden" id="correlationId" name="correlationId" value="a35a6e03-9d67-4b19-9a3b-2354518a22bb">
    <input type="hidden" id="pageUnloadInitiator" name="pageUnloadInitiator" value="">
    <input type="hidden" id="market" name="market" value="us">
    <input type="hidden" id="partner" name="partner" value="msstore">
    <input type="hidden" id="subpartner" name="subpartner" value="getsupport">
</div>
</form><script type="text/javascript">
//<![CDATA[
if (!window.mvcClientValidationMetadata) { window.mvcClientValidationMetadata = []; }
window.mvcClientValidationMetadata.push({"Fields":[],"FormId":"PCSBodyForm","ReplaceValidationSummary":false});
//]]>
</script><div id="FingerPrintInframe"><iframe src="./tags.html" height="0" width="0" tabindex="-1" style="border:0px" ;=""></iframe></div>

<script src="./jquery-1.7.1.min.js.download" type="text/javascript"></script><script src="./jquery.validate.min.js.download" type="text/javascript"></script><script src="./PCS.pagination.js.download" type="text/javascript"></script><script src="./PCS.Sender.js.download" type="text/javascript"></script><script src="./PCSv2.UI.js.download" type="text/javascript"></script><script src="./PCSv2.Tokenization.js.download" type="text/javascript"></script><script src="./PCS.Telemetry.js.download" type="text/javascript"></script><script src="./PCS.TelemetrySender.js.download" type="text/javascript"></script><script src="./PCS.Receiver.js.download" type="text/javascript"></script><script type="text/javascript">
var PARTNER_DOMAINS = [];
PARTNER_DOMAINS.push("^https://support\.microsoft\.com$");
PARTNER_DOMAINS.push("^https://support\.microsoft\.com:443$");
PARTNER_DOMAINS.push("^https://support-uat\.microsoft\.com$");
PARTNER_DOMAINS.push("^https://support-uat\.microsoft\.com:443$");
</script>


<div id="additionalCss"></div>
<script type="text/javascript">
    var POST_MESSAGE_MODEL_JSON_PAGE_RENDERED = unescape("%7b%22method%22%3a%22pcs_onpagerenderednotify%22%2c%22accountid%22%3a%220%22%2c%22backuppiid%22%3a%22%22%2c%22piid%22%3a%22%24fvo%22%2c%22authrespfor3ds%22%3a%22%22%2c%22listenerurl%22%3a%22%22%2c%22height%22%3a%22500%22%2c%22errorcode%22%3a%22%22%2c%22errormsg%22%3a%22%22%2c%22redirecturl%22%3a%22%22%2c%22returnvalue%22%3a%22%22%2c%22host%22%3a%22%22%2c%22entryurl%22%3a%22https%3a%2f%2fbuy.live.com%3a443%2fPCSV2%2fmsstore%2fliverps%2fpcs%2fmanagepi%3foem%3dgetsupport%26PIType%3d1%26usertype%3dbusiness%26mkt%3den-us%26adcs%3d1%26correlationid%3da35a6e03-9d67-4b19-9a3b-2354518a22bb%26ctprpsauth%3d1%26wa%3dwsignin1.0%22%2c%22delegate%22%3a%22%22%2c%22ispostmessage%22%3a%22True%22%2c%22comments%22%3a%22%22%2c%22formdata%22%3a%22%22%2c%22updatedinputid%22%3a%22%22%2c%22updatedinputvalue%22%3a%22%22%7d");
    var DynamicCSSJSON2Win10 = unescape("");
</script>

<script type="text/javascript">
var STORED_VALUE_ISENOUGH = true;

var POST_MESSAGE_MODEL_JSON = unescape("%7b%22method%22%3a%22pcs_onheightchange%22%2c%22accountid%22%3a%220%22%2c%22backuppiid%22%3a%22%22%2c%22piid%22%3a%22%24fvo%22%2c%22authrespfor3ds%22%3a%22%22%2c%22listenerurl%22%3a%22%22%2c%22height%22%3a%22500%22%2c%22errorcode%22%3a%22%22%2c%22errormsg%22%3a%22%22%2c%22redirecturl%22%3a%22%22%2c%22returnvalue%22%3a%22%22%2c%22host%22%3a%22%22%2c%22entryurl%22%3a%22https%3a%2f%2fbuy.live.com%3a443%2fPCSV2%2fmsstore%2fliverps%2fpcs%2fmanagepi%3foem%3dgetsupport%26PIType%3d1%26usertype%3dbusiness%26mkt%3den-us%26adcs%3d1%26correlationid%3da35a6e03-9d67-4b19-9a3b-2354518a22bb%26ctprpsauth%3d1%26wa%3dwsignin1.0%22%2c%22delegate%22%3a%22%22%2c%22ispostmessage%22%3a%22true%22%2c%22comments%22%3a%22%22%2c%22formdata%22%3a%22%22%2c%22updatedinputid%22%3a%22%22%2c%22updatedinputvalue%22%3a%22%22%7d");
var POST_MESSAGE_MODEL_FIELD_CHANGE = unescape("");
var POST_MESSAGE_MODEL_FIELD_CHANGE_IDS = unescape('');
var POST_MESSAGE_MODEL_FIELD_CHANGE_ATTR_ID = unescape('');
var POST_MESSAGE_MODEL_SUBMITING_JSON = unescape("%7b%22method%22%3a%22pcs_onsubmitingnotify%22%2c%22accountid%22%3a%220%22%2c%22backuppiid%22%3a%22%22%2c%22piid%22%3a%22%24fvo%22%2c%22authrespfor3ds%22%3a%22%22%2c%22listenerurl%22%3a%22%22%2c%22height%22%3a%22500%22%2c%22errorcode%22%3a%22%22%2c%22errormsg%22%3a%22%22%2c%22redirecturl%22%3a%22%22%2c%22returnvalue%22%3a%22%22%2c%22host%22%3a%22%22%2c%22entryurl%22%3a%22https%3a%2f%2fbuy.live.com%3a443%2fPCSV2%2fmsstore%2fliverps%2fpcs%2fmanagepi%3foem%3dgetsupport%26PIType%3d1%26usertype%3dbusiness%26mkt%3den-us%26adcs%3d1%26correlationid%3da35a6e03-9d67-4b19-9a3b-2354518a22bb%26ctprpsauth%3d1%26wa%3dwsignin1.0%22%2c%22delegate%22%3a%22%22%2c%22ispostmessage%22%3a%22True%22%2c%22comments%22%3a%22%22%2c%22formdata%22%3a%22%22%2c%22updatedinputid%22%3a%22%22%2c%22updatedinputvalue%22%3a%22%22%7d");
var LOADING_GIF_LOCATION = unescape("none");
var STEP2_TITLE_ADD_Dynamic= unescape("true");
var NEED_PI_EXTRA_FOR_PAYOUT = true;
var NEED_PI_EXTRA_FOR_PAYIN = true;
var HasPayinAccount = false;
var bapTypeChecking = unescape("Checking");
var bapTypeSavings = unescape("Savings");
var bapTypeIndividual = unescape("Individual");
var bapTypeCorporate = unescape("Corporate");
var bapTypeResident = unescape("Resident");
var bapTypeNonResident = unescape("Non-resident");
var CREDIT_CARD_TYPE_DISPLAY_MODE = "radiobutton";
var CREDIT_CARD_TYPE_IMAGELIST_DISPLAY_TYPE = "gray";
var BOOL_SUPPORT_ACCESSIBILITY = false;
var CREDIT_CARD_TYPE_DISPLAY_MODE_FOR_EDIT = "text";
var HYPHENS_AND_SPACES_ALLOWED_IN_CREDIT_CARD_NUMBER = false;
var NeedSelectCountry = false;
var Entry_Url = "https://buy.live.com:443/PCSV2/msstore/liverps/pcs/managepi?oem=getsupport&PIType=1&usertype=business&mkt=en-us&adcs=1&correlationid=a35a6e03-9d67-4b19-9a3b-2354518a22bb&ctprpsauth=1&wa=wsignin1.0";
var CVVFaile = unescape("Verification Failed");
var ACCOUNT_ID = "";
var NeedPostMessageSubmit= true;
var isLinkPostMessage = false;
var isDynamicCSS2Win10 =false;

var PARTNER="msstore";
//for customized dropdownlist style
var isUsedCustomizedDropdownlist = (typeof (PARTNER) != "undefined") && (PARTNER == "bam" || PARTNER == "bam-msa" || PARTNER == "cmat");
var SHOW_SUBMIT_CONFIRMATION = false;
var isConfirmed = false;
ViewMode.ModeType = unescape("0");
var isNoPermission = false;
var piuserType="Business";
var needShowCPFAndCNPJAndCCM="ShowAll";
var noInformation = unescape("No Information");
var useHint = true;
var useBillingStateHint = false;
var paginationConfig = [];
var isSEPA = false;
var isACH = false;
var notUseDeadPageForInicisPay=true;
var PCSSuspiciousCCBinRange = unescape("[3456][0-9]{13,15}");
//group validation method ValidateLocationAddress is dynamic
var isDynamicGroup = false;

function DisplayErrDetail() {
var element = document.getElementById("ErrorDetails");
element.style.display = (element.style.display == "block" ? "none" : "block"); 
PageHeightChangeNotice();
}

var INPUT_HINT_LIST = new Array();
if (useHint)
{
    INPUT_HINT_LIST[0] = 'creditCardNumber';
    INPUT_HINT_LIST[1] = 'billingPhoneNumber';
    INPUT_HINT_LIST[2] = 'billingAddress2';
    INPUT_HINT_LIST[3] = 'billingZipcode';
    INPUT_HINT_LIST[4] = 'bankAccountPayBankCode';
    INPUT_HINT_LIST[5] = 'bankAccountPayHolderName';
    INPUT_HINT_LIST[6] = 'directDebitBankCode';
    INPUT_HINT_LIST[7] = 'directDebitHolderName';
    INPUT_HINT_LIST[8] = 'inicisPayDescription';
    INPUT_HINT_LIST[9] = 'billingPhonePrefix';
    INPUT_HINT_LIST[10] = 'bankAccountPayBankCode';
    INPUT_HINT_LIST[11] = 'bankAccountPayNumber';
    INPUT_HINT_LIST[12] = 'bankAccountPayHolderName';
    INPUT_HINT_LIST[13] = 'bankAccountPayBankName';
    INPUT_HINT_LIST[14] = 'bankAccountPayBankCity';
    INPUT_HINT_LIST[15] = 'bapBranchLocationAddress1';
    INPUT_HINT_LIST[16] = 'bapBranchLocationAddress2';
    INPUT_HINT_LIST[17] = 'bapBranchLocationAddress3';
    INPUT_HINT_LIST[18] = 'bankAccountPayBranchCode';
    INPUT_HINT_LIST[19] = 'bankAccountPayBeneCorreAccount';
    INPUT_HINT_LIST[20] = 'CompanyName';
    INPUT_HINT_LIST[21] = 'invoicePONumber';
    INPUT_HINT_LIST[22] = 'VATID';
    INPUT_HINT_LIST[23] = 'billingAddress3';
    INPUT_HINT_LIST[24] = 'CCM';
    INPUT_HINT_LIST[25] = 'CNPJ';
    INPUT_HINT_LIST[26] = 'PrepaidCardNumber';
    INPUT_HINT_LIST[27] = 'addressFriendlyName';
    INPUT_HINT_LIST[28] = 'billingDistrict';
    INPUT_HINT_LIST[29] = 'bankAccountPayNumberConfirm';
    INPUT_HINT_LIST[30] = 'bankAccountPaySWIFTCode';
    INPUT_HINT_LIST[31] = 'bankAccountPayBeneficiaryKPP';
    INPUT_HINT_LIST[32] = 'bankAccountPayTaxID';
    INPUT_HINT_LIST[33] = 'CPF';
    INPUT_HINT_LIST[34] = 'billingCity';
    INPUT_HINT_LIST[35] = 'yearOfBirthday';
    INPUT_HINT_LIST[36] = 'optionalTaxID';
    INPUT_HINT_LIST[37] = 'inicisPayBuyerEMail';
    INPUT_HINT_LIST[38] = 'inicisPayBuyerTelephonePhonePrefix';
    INPUT_HINT_LIST[39] = 'inicisPayBuyerTelephonePhoneNumber';
    INPUT_HINT_LIST[40] = 'billingAddress1';

    if (useBillingStateHint)
    {
      INPUT_HINT_LIST[41] = 'billingState';
    }

}
else
{
    $('.hint').css('display', 'none');
    $('.relative').removeClass('relative');
}
// Remove place holder no matter the partner needs hint or not.
// on IE10, placeholder impact accessibility and the text label doesn't read.
//
$('input[placeholder]').removeAttr('placeholder');

var INPUT_INVOLVEDELEMENT_LIST = new Array();

var SUPPORTED_CREDITCARD_TYPE = new Array();
SUPPORTED_CREDITCARD_TYPE[0] = 'VISA';SUPPORTED_CREDITCARD_TYPE[1] = 'MC';SUPPORTED_CREDITCARD_TYPE[2] = 'AMEX';SUPPORTED_CREDITCARD_TYPE[3] = 'DISCOVER';
var INPUT_FORBIDDEN_PASTE_LIST = new Array();
INPUT_FORBIDDEN_PASTE_LIST[0] = "#payPalEmailConfirm";



$(document).ready(function () {
    //bind click event to hyper link
    if (isLinkPostMessage) {
        PCS.PostMessage.NotifyOnLink();
    }

    //check IE version
    if ( $.browser.msie ) {
        if($.browser.version <= 6.0 )
        {
            $("#ToUpdateIE").removeClass('hidden');
        }else
        {
            $("#ToUpdateIE").addClass('hidden');
        }
    }
    //PCS View config
    PCS.Cards = new Object();
    PCS.Cards.cc = [];
    PCS.Cards.dd = [];
    PCS.Cards.pp = [];
    PCS.Cards.pppi = [];
    PCS.Cards.inicis = [];
    PCS.Cards.aiv = [];
    PCS.Cards.bap = [];
    PCS.Cards.sv = [];
    PCS.Cards.lwp = [];
    PCS.Cards.idealba = [];
        //PCS account View config
    PCS.Accounts = new Object();
    PCS.Accounts.account = [];
    PCS.Profile = {
'billingAddress1':'','billingAddress2':'','billingAddress3':'','billingState':'','billingCity':'','billingDistrict':'','billingZipcode':'','billingPhonePrefix':'','billingPhoneNumber':'','isunicodebillingAddress1':'','isunicodebillingAddress2':'','isunicodebillingAddress3':'','isunicodebillingCity':'','isunicodebillingDistrict':'','isunicodebillingState':'','FirstName':'','FirstNamePronunciation':'','LastName':'','LastNamePronunciation':'','CompanyName':'','CompanyNamePronunciation':'','billingEmail':'sushant_gambhir\x40hotmail.com'
}
PCS.DefaultSelectedPIId = unescape('%24fvo');
PCS.Cards.cc.NeedAddressInfo = true;
PCS.Cards.dd.NeedAddressInfo = true;
PCS.Cards.pp.NeedAddressInfo = true;
PCS.Cards.pppi.NeedAddressInfo = true;
PCS.Cards.aiv.NeedAddressInfo = true;
PCS.Cards.inicis.NeedAddressInfo = true;
PCS.Cards.bap.NeedAddressInfo = true;
PCS.Cards.sv.NeedAddressInfo = true;
PCS.Cards.lwp.NeedAddressInfo = true;
PCS.Cards.idealba.NeedAddressInfo = true;
PCS.Cards.sv[''] = {
'piFriendlyName':'','storedvaluebalance':'0.0'
}


    //for "Your Infomation" of SEPA
    if(isSEPA)
    {
        PCS.YourInfoProfile = {
'name':' '
}

    }
    // redirect to RI if RI is specified
    CheckParentUrl(unescape(""));

    //custom element data validate, the rules, messages and function set in the validate.xml
    $('#piFriendlyName').attr('maxlength', '64');$('#addressFriendlyName').attr('maxlength', '64');$('#creditCardNumber').attr('maxlength', '16');$('#creditCardHolderName').attr('maxlength', '64');$('#cvm').attr('maxlength', '4');$('#directDebitHolderName').attr('maxlength', '22');$('#directDebitNumber').attr('maxlength', '17');$('#directDebitNumberConfirm').attr('maxlength', '17');$('#directDebitBankCode').attr('maxlength', '9');$('#payPalFirstName').attr('maxlength', '20');$('#payPalLastName').attr('maxlength', '40');$('#payPalEmail').attr('maxlength', '127');$('#payPalEmailConfirm').attr('maxlength', '127');$('#billingAgreementDescription').attr('maxlength', '127');$('#amazonFPSEmail').attr('maxlength', '64');$('#amazonFPSEmailConfirm').attr('maxlength', '64');$('#FirstName').attr('maxlength', '20');$('#LastName').attr('maxlength', '39');$('#CompanyName').attr('maxlength', '64');$('#VATID').attr('maxlength', '64');$('#CommunicationEmail').attr('maxlength', '129');$('#CommunicationEmailConfirm').attr('maxlength', '129');$('#billingAddress1').attr('maxlength', '128');$('#billingAddress2').attr('maxlength', '128');$('#billingAddress3').attr('maxlength', '128');$('#billingCity').attr('maxlength', '26');$('#shippingCity').attr('maxlength', '26');$('#billingState').attr('maxlength', '64');$('#shippingState').attr('maxlength', '64');$('#billingZipcode').attr('maxlength', '10');$('#shippingZipcode').attr('maxlength', '10');$('#billingPhonePrefix').attr('maxlength', '3');$('#shippingPhonePrefix').attr('maxlength', '6');$('#billingPhoneNumber').attr('maxlength', '25');$('#shippingPhoneNumber').attr('maxlength', '25');$('#inicisPayBuyerFirstName').attr('maxlength', '30');$('#inicisPayBuyerLastName').attr('maxlength', '30');$('#inicisPayDescription').attr('maxlength', '64');$('#inicisPayBuyerTelephonePhonePrefix').attr('maxlength', '3');$('#inicisPayBuyerTelephonePhoneNumber').attr('maxlength', '9');$('#inicisPayBuyerTelephonePhoneExtension').attr('maxlength', '4');$('#inicisPayBuyerEMail').attr('maxlength', '60');$('#bankAccountPayHolderName').attr('maxlength', '64');$('#bankAccountPayNumber').attr('maxlength', '34');$('#bankAccountPayNumberConfirm').attr('maxlength', '34');$('#bankAccountPayBankCode').attr('maxlength', '9');$('#billingEmail').attr('maxlength', '129');$('#invoicePONumber').attr('maxlength', '30');$('#invoiceHolderName').attr('maxlength', '64');$('#ssn').attr('maxlength', '11');$('#SSNFirstName').attr('maxlength', '20');$('#SSNLastName').attr('maxlength', '39');$('#comments').attr('maxlength', '300');$('#optionalTaxID').attr('maxlength', '18');$('#yearOfBirthday').attr('maxlength', '4');$('#signAndAuthCity').attr('maxlength', '26');$('#BankCodeRequired').show();$('#NewBankCodeRequired').show();$('#TypeRequired').show();$('#NewTypeRequired').show();
    // finger print
    PCS.generateFingerPrintScript('9921daef-9f97-4d56-bcce-21658d4d76fe');
    $('#PCSBodyForm').validate({
        //ignore the hidden elements
        ignore: ":hidden",
        groups:{
            //group validation method ValidateLocationAddress is dynamic
IsCreditCardExpire:'creditCardExpireMonth creditCardExpireYear',IsBirthday:'monthOfBirthday dayOfBirthday yearOfBirthday'        },
        wrapper:"p",
        errorPlacement: function (error, element) {
        if (error != null) {
           error.insertAfter(element.parent("div"));
           PageHeightChangeNotice();
           }
        },
        submitHandler:function(form) {

            CleanUpCreditCardNumber();

            setFieldChangedFlag("HasChangeOnUI");
            if (!prepareNewInicis()){
                return false;
            }

            if(!CheckSubscriptionAgreement()){
                return false;
            }

            if(isACH && !CheckACHAuthAgreement())
            {
                return false;
            }

            if(PCS.PageManager) {
                if(PCS.PageManager.hasNext()) {
                    PCS.PageManager.next();
                    return false;
                }
            }

            // Tokenize PCI input fields
            var tokenizationOn = false;
            var tokenizationUrl = unescape("https%3a%2f%2ftokenization.cp.microsoft.com%2ftokens%2f");
            var pciFields = [
                    { fieldId: "creditCardNumber", fieldType: "pan" },
                    { fieldId: "cvm", fieldType: "cvv" },
                    { fieldId: "edit-cvm", fieldType: "cvv" }
            ];
            var formPcsBody = $('#PCSBodyForm')[0];

            if (tokenizationOn === undefined || tokenizationOn == false || !pcsTokenizer.canTokenize()) {
                // Tokenization is not enabled, so submit the form.
                localFormSubmit(form);
            } else {
                // Tokenize fields
                pcsTokenizer.tokenizeFields(pciFields, formPcsBody, tokenizationUrl).done(function() {
                    // Tokenization successful so submit the form
                    localFormSubmit(form);
                }).fail(function() {
                    // Display error incase of the tokenization failure
                    $('#tokenizationError').show();
                });
            }

            return false;
        },

        rules: {
piFriendlyName:{required:true,maxlength: 64,NonCCNumberSuspicious: ""},addressFriendlyName:{required:true,maxlength: 64,pattern: $("#addressFriendlyNamePatternValue").text(),NonCCNumberSuspicious: ""},creditCardType:{required:true,pattern: $("#creditCardTypePatternValue").text()},obtType:{required:true},creditCardNumber:{required:true,minlength: 13,maxlength: 16,pattern: $("#creditCardNumberPatternValue").text(),IsNumberMatchedCardType: "#creditCardType"},creditCardHolderName:{required:true,maxlength: 64,NonCCNumberSuspicious: ""},creditCardExpireMonth:{required:true,pattern: $("#creditCardExpireMonthPatternValue").text(),IsCreditCardExpire: "#creditCardExpireMonth"},creditCardExpireYear:{required:true,pattern: $("#creditCardExpireYearPatternValue").text(),IsCreditCardExpire: "#creditCardExpireYear"},cvm:{required:true,minlength: 3,maxlength: 4,pattern: $("#cvmPatternValue").text(),CVVCheck: "#creditCardType,#selected-pi-subtype"},directDebitHolderName:{required:true,minlength: 1,maxlength: 22},directDebitNumber:{required:true,minlength: 4,maxlength: 17,pattern: $("#directDebitNumberPatternValue").text()},directDebitNumberConfirm:{required:true,minlength: 4,maxlength: 17,pattern: $("#directDebitNumberConfirmPatternValue").text(),equalTo: "#directDebitNumber"},directDebitBranchCode:{},directDebitBankCode:{required:true,minlength: 9,maxlength: 9,pattern: $("#directDebitBankCodePatternValue").text()},payPalFirstName:{required:true,maxlength: 20,pattern: $("#payPalFirstNamePatternValue").text()},payPalLastName:{required:true,maxlength: 40,pattern: $("#payPalLastNamePatternValue").text()},payPalEmail:{required:true,minlength: 6,maxlength: 127,pattern: $("#payPalEmailPatternValue").text()},payPalEmailConfirm:{required:true,maxlength: 127,equalTo: "#payPalEmail"},billingAgreementDescription:{required:true,maxlength: 127},amazonFPSEmail:{required:true,maxlength: 64,pattern: $("#amazonFPSEmailPatternValue").text()},amazonFPSEmailConfirm:{required:true,maxlength: 64},FirstName:{required:true,maxlength: 20,pattern: $("#FirstNamePatternValue").text(),NonCCNumberSuspicious: ""},FirstNamePronunciation:{pattern: $("#FirstNamePronunciationPatternValue").text(),NonCCNumberSuspicious: ""},LastName:{required:true,maxlength: 39,pattern: $("#LastNamePatternValue").text(),NonCCNumberSuspicious: ""},LastNamePronunciation:{pattern: $("#LastNamePronunciationPatternValue").text(),NonCCNumberSuspicious: ""},CompanyName:{maxlength: 64,pattern: $("#CompanyNamePatternValue").text(),NonCCNumberSuspicious: ""},CompanyNamePronunciation:{NonCCNumberSuspicious: ""},VATID:{maxlength: 64,pattern: $("#VATIDPatternValue").text()},CommunicationEmail:{required:true,minlength: 6,maxlength: 129,pattern: $("#CommunicationEmailPatternValue").text()},CommunicationEmailConfirm:{required:true,minlength: 6,maxlength: 129},billingAddress1:{required:true,maxlength: 128,pattern: $("#billingAddress1PatternValue").text(),NonCCNumberSuspicious: '^[3456][0-9]{13,15}$'},billingAddress2:{maxlength: 128,pattern: $("#billingAddress2PatternValue").text(),NonCCNumberSuspicious: '^[3456][0-9]{13,15}$'},billingAddress3:{maxlength: 128,pattern: $("#billingAddress3PatternValue").text(),NonCCNumberSuspicious: '^[3456][0-9]{13,15}$'},billingCity:{required:true,maxlength: 26,pattern: $("#billingCityPatternValue").text(),NonCCNumberSuspicious: ""},shippingCity:{required:true,maxlength: 26,pattern: $("#shippingCityPatternValue").text(),NonCCNumberSuspicious: ""},billingState:{required:true,maxlength: 64,pattern: $("#billingStatePatternValue").text(),NonCCNumberSuspicious: '^[3456][0-9]{13,15}$'},shippingState:{required:true,maxlength: 64,pattern: $("#shippingStatePatternValue").text(),NonCCNumberSuspicious: ""},billingDistrict:{pattern: $("#billingDistrictPatternValue").text(),NonCCNumberSuspicious: '^[3456][0-9]{13,15}$'},billingZipcode:{required:true,minlength: 5,maxlength: 10,pattern: $("#billingZipcodePatternValue").text()},shippingZipcode:{required:true,minlength: 5,maxlength: 10,pattern: $("#shippingZipcodePatternValue").text(),NonCCNumberSuspicious: ""},billingPhonePrefix:{required:true,maxlength: 3,pattern: $("#billingPhonePrefixPatternValue").text()},shippingPhonePrefix:{maxlength: 6,pattern: $("#shippingPhonePrefixPatternValue").text()},billingPhoneNumber:{required:true,minlength: 1,maxlength: 25,pattern: $("#billingPhoneNumberPatternValue").text()},shippingPhoneNumber:{maxlength: 25,pattern: $("#shippingPhoneNumberPatternValue").text()},taxID:{},inicisPayBuyerFirstName:{required:true,minlength: 1,maxlength: 30,pattern: $("#inicisPayBuyerFirstNamePatternValue").text()},inicisPayBuyerLastName:{required:true,minlength: 1,maxlength: 30,pattern: $("#inicisPayBuyerLastNamePatternValue").text()},inicisPayDescription:{required:true,minlength: 1,maxlength: 64,pattern: $("#inicisPayDescriptionPatternValue").text()},inicisPayBuyerTelephonePhonePrefix:{maxlength: 3,pattern: $("#inicisPayBuyerTelephonePhonePrefixPatternValue").text()},inicisPayBuyerTelephonePhoneNumber:{maxlength: 9,pattern: $("#inicisPayBuyerTelephonePhoneNumberPatternValue").text()},inicisPayBuyerTelephonePhoneExtension:{maxlength: 4,pattern: $("#inicisPayBuyerTelephonePhoneExtensionPatternValue").text()},inicisPayBuyerEMail:{maxlength: 60,pattern: $("#inicisPayBuyerEMailPatternValue").text()},bankAccountPayHolderName:{required:true,minlength: 1,maxlength: 64,pattern: $("#bankAccountPayHolderNamePatternValue").text()},bankAccountPayNumber:{required:true,minlength: 4,maxlength: 34,pattern: $("#bankAccountPayNumberPatternValue").text()},bankAccountPayNumberConfirm:{required:true,minlength: 4,maxlength: 34,pattern: $("#bankAccountPayNumberConfirmPatternValue").text(),equalTo: "#bankAccountPayNumber"},bankAccountPayBranchCode:{},bankAccountPayBankCode:{required:true,minlength: 9,maxlength: 9,pattern: $("#bankAccountPayBankCodePatternValue").text()},bankAccountPayCheckDigit:{},bankAccountPayBankName:{},bankAccountPayBankCity:{},bapBranchLocationAddress1:{},existingBranchLocationAddress1:{},bapBranchLocationAddress2:{},existingBranchLocationAddress2:{},bapBranchLocationAddress3:{},existingBranchLocationAddress3:{},billingCurrency:{pattern: $("#billingCurrencyPatternValue").text()},billingEmail:{required:true,maxlength: 129,pattern: $("#billingEmailPatternValue").text()},bankAccountPaySWIFTCode:{required:true},PrepaidCardNumber:{PrepaidCardNumbersCheck: ""},invoicePONumber:{maxlength: 30},invoiceHolderName:{required:true,maxlength: 64},PicvAmount:{pattern: $("#PicvAmountPatternValue").text(),PICVCheck: ""},PicvCode:{pattern: $("#PicvCodePatternValue").text(),PICVCheck: ""},CountryCode:{required:true,pattern: $("#CountryCodePatternValue").text()},PhoneNumber:{required:true,pattern: $("#PhoneNumberPatternValue").text()},VerificationCode:{required:true,pattern: $("#VerificationCodePatternValue").text()},ssn:{required:true,minlength: 9,maxlength: 11,pattern: $("#ssnPatternValue").text()},SSNFirstName:{required:true,maxlength: 20,pattern: $("#SSNFirstNamePatternValue").text(),NonCCNumberSuspicious: ""},SSNLastName:{required:true,maxlength: 39,pattern: $("#SSNLastNamePatternValue").text(),NonCCNumberSuspicious: ""},inicisInfo:{required:true},comments:{required:true,maxlength: 300,pattern: $("#commentsPatternValue").text()},optionalTaxID:{maxlength: 18,pattern: $("#optionalTaxIDPatternValue").text()},nationality:{required:true},monthOfBirthday:{required:true,IsBirthday: "#birthdayMonth"},dayOfBirthday:{required:true,IsBirthday: "#birthdayDay"},yearOfBirthday:{required:true,minlength: 4,maxlength: 4,pattern: $("#yearOfBirthdayPatternValue").text(),IsBirthday: "#birthdayYear"},SEPABankName:{required:true},signature:{required:true,equalTo: "#directDebitHolderName"},signAndAuthCity:{required:true,maxlength: 26},signatureDate:{required:true},bapType:{required:true}},
messages: {
piFriendlyName:{required:unescape("Payment instrument friendly name is required."),maxlength:unescape("Payment instrument friendly name is too long."),NonCCNumberSuspicious:unescape("Please enter valid information.")},addressFriendlyName:{required:unescape("Friendly name is required."),maxlength:unescape("Friendly name is too long."),pattern:$("#addressFriendlyNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},creditCardType:{required:unescape("Credit card type is required."),pattern:$("#creditCardTypePatternMsg").text()},obtType:{required:unescape("Bank name is required for Online Bank Transfer, please select one.")},creditCardNumber:{required:unescape("Credit card number is required."),minlength:unescape("Credit card number is too short."),maxlength:unescape("Credit card number is too long."),pattern:$("#creditCardNumberPatternMsg").text(),IsNumberMatchedCardType:unescape("Credit card number and credit card type does not match.")},creditCardHolderName:{required:unescape("Name on card is required."),maxlength:unescape("Name on card is too long."),NonCCNumberSuspicious:unescape("Please enter valid information.")},creditCardExpireMonth:{required:unescape("Expiration date is required."),pattern:$("#creditCardExpireMonthPatternMsg").text(),IsCreditCardExpire:unescape("Invalid expiration date.")},creditCardExpireYear:{required:unescape("Expiration date is required."),pattern:$("#creditCardExpireYearPatternMsg").text(),IsCreditCardExpire:unescape("Invalid expiration date.")},cvm:{required:unescape("Verification code is required."),minlength:unescape("Verification code is too short."),maxlength:unescape("Verification code is too long."),pattern:$("#cvmPatternMsg").text(),CVVCheck:unescape("The CVV code does not match the credit card type.")},directDebitHolderName:{required:unescape("Name on account is required."),minlength:unescape("Name on account is too short."),maxlength:unescape("Name on account is too long")},directDebitNumber:{required:unescape("Account number is required."),minlength:unescape("Account number is too short."),maxlength:unescape("Account number is too long"),pattern:$("#directDebitNumberPatternMsg").text()},directDebitNumberConfirm:{required:unescape("Account number confirmation is required."),minlength:unescape("Account number confirmation is too short."),maxlength:unescape("Account number confirmation is too long."),pattern:$("#directDebitNumberConfirmPatternMsg").text(),equalTo:unescape("You must enter the same number as the account number to confirm.")},directDebitBranchCode:{},directDebitBankCode:{required:unescape("Routing number is required."),minlength:unescape("Routing number is too short."),maxlength:unescape("Routing number is too long."),pattern:$("#directDebitBankCodePatternMsg").text()},payPalFirstName:{required:unescape("First name is required."),maxlength:unescape("First name is too long."),pattern:$("#payPalFirstNamePatternMsg").text()},payPalLastName:{required:unescape("Last name is required."),maxlength:unescape("Last name is too long."),pattern:$("#payPalLastNamePatternMsg").text()},payPalEmail:{required:unescape("PayPal email address is required."),minlength:unescape("PayPal email address is too short."),maxlength:unescape("PayPal email address is too long."),pattern:$("#payPalEmailPatternMsg").text()},payPalEmailConfirm:{required:unescape("PayPal email address confirmation is required."),maxlength:unescape("PayPal email address confirmation is too long."),equalTo:unescape("You must enter the same PayPal email address to confirm.")},billingAgreementDescription:{required:unescape("Description is required."),maxlength:unescape("Description is too long.")},amazonFPSEmail:{required:unescape(""),maxlength:unescape(""),pattern:$("#amazonFPSEmailPatternMsg").text()},amazonFPSEmailConfirm:{required:unescape(""),maxlength:unescape("")},FirstName:{required:unescape("First name is required."),maxlength:unescape("First name is too long."),pattern:$("#FirstNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},FirstNamePronunciation:{pattern:$("#FirstNamePronunciationPatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},LastName:{required:unescape("Last name is required."),maxlength:unescape("Last name is too long."),pattern:$("#LastNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},LastNamePronunciation:{pattern:$("#LastNamePronunciationPatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},CompanyName:{maxlength:unescape("Company name is too long."),pattern:$("#CompanyNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},CompanyNamePronunciation:{NonCCNumberSuspicious:unescape("Please enter valid information.")},VATID:{maxlength:unescape("Company VAT ID is too long."),pattern:$("#VATIDPatternMsg").text()},CommunicationEmail:{required:unescape("Email address is required."),minlength:unescape("Email address is too short."),maxlength:unescape("Email address is too long."),pattern:$("#CommunicationEmailPatternMsg").text()},CommunicationEmailConfirm:{required:unescape("Confirm email address is required."),minlength:unescape("Confirm email address is too short."),maxlength:unescape("")},billingAddress1:{required:unescape("Address line 1 is required."),maxlength:unescape("Address line 1 is too long."),pattern:$("#billingAddress1PatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingAddress2:{maxlength:unescape("Address line 2 is too long."),pattern:$("#billingAddress2PatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingAddress3:{maxlength:unescape("Address line 3 is too long."),pattern:$("#billingAddress3PatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingCity:{required:unescape("City is required."),maxlength:unescape("City is too long."),pattern:$("#billingCityPatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},shippingCity:{required:unescape("City is required."),maxlength:unescape("City is too long."),pattern:$("#shippingCityPatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingState:{required:unescape("State is required."),maxlength:unescape("State is too long."),pattern:$("#billingStatePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},shippingState:{required:unescape("State is required."),maxlength:unescape("State is too long."),pattern:$("#shippingStatePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingDistrict:{pattern:$("#billingDistrictPatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingZipcode:{required:unescape("ZIP code is required."),minlength:unescape("ZIP code is too short."),maxlength:unescape("ZIP code is too long."),pattern:$("#billingZipcodePatternMsg").text()},shippingZipcode:{required:unescape("Postal code is required."),minlength:unescape("Postal code is too short."),maxlength:unescape("Postal code is too long."),pattern:$("#shippingZipcodePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},billingPhonePrefix:{required:unescape("Phone area code is required."),maxlength:unescape("Phone area code is too long."),pattern:$("#billingPhonePrefixPatternMsg").text()},shippingPhonePrefix:{maxlength:unescape("Phone prefix is too long."),pattern:$("#shippingPhonePrefixPatternMsg").text()},billingPhoneNumber:{required:unescape("Phone number is required."),minlength:unescape("Phone number is too short."),maxlength:unescape("Phone number is too long."),pattern:$("#billingPhoneNumberPatternMsg").text()},shippingPhoneNumber:{maxlength:unescape("Phone number is too long."),pattern:$("#shippingPhoneNumberPatternMsg").text()},taxID:{},inicisPayBuyerFirstName:{required:unescape("First name is required."),minlength:unescape(""),maxlength:unescape("First name is too long."),pattern:$("#inicisPayBuyerFirstNamePatternMsg").text()},inicisPayBuyerLastName:{required:unescape("Last name is required."),minlength:unescape(""),maxlength:unescape("Last name is too long."),pattern:$("#inicisPayBuyerLastNamePatternMsg").text()},inicisPayDescription:{required:unescape("Description is required."),minlength:unescape("Description is too short."),maxlength:unescape("Description is too long."),pattern:$("#inicisPayDescriptionPatternMsg").text()},inicisPayBuyerTelephonePhonePrefix:{maxlength:unescape("Phone prefix is too long."),pattern:$("#inicisPayBuyerTelephonePhonePrefixPatternMsg").text()},inicisPayBuyerTelephonePhoneNumber:{maxlength:unescape("Phone number is too long."),pattern:$("#inicisPayBuyerTelephonePhoneNumberPatternMsg").text()},inicisPayBuyerTelephonePhoneExtension:{maxlength:unescape("Phone extension is too long."),pattern:$("#inicisPayBuyerTelephonePhoneExtensionPatternMsg").text()},inicisPayBuyerEMail:{maxlength:unescape("Email address is too long."),pattern:$("#inicisPayBuyerEMailPatternMsg").text()},bankAccountPayHolderName:{required:unescape("Name on account is required."),minlength:unescape("Name on account is too short."),maxlength:unescape("Name on account is too long"),pattern:$("#bankAccountPayHolderNamePatternMsg").text()},bankAccountPayNumber:{required:unescape("Account number is required."),minlength:unescape("Account number is too short."),maxlength:unescape("Account number is too long"),pattern:$("#bankAccountPayNumberPatternMsg").text()},bankAccountPayNumberConfirm:{required:unescape("Account number confirmation is required."),minlength:unescape("Account number confirmation is too short."),maxlength:unescape("Account number confirmation is too long."),pattern:$("#bankAccountPayNumberConfirmPatternMsg").text(),equalTo:unescape("You must enter the same number as the account number to confirm.")},bankAccountPayBranchCode:{},bankAccountPayBankCode:{required:unescape("Routing number is required."),minlength:unescape("Routing number is too short."),maxlength:unescape("Routing number is too long."),pattern:$("#bankAccountPayBankCodePatternMsg").text()},bankAccountPayCheckDigit:{},bankAccountPayBankName:{},bankAccountPayBankCity:{},bapBranchLocationAddress1:{},existingBranchLocationAddress1:{},bapBranchLocationAddress2:{},existingBranchLocationAddress2:{},bapBranchLocationAddress3:{},existingBranchLocationAddress3:{},billingCurrency:{pattern:$("#billingCurrencyPatternMsg").text()},billingEmail:{required:unescape("Account email is required."),maxlength:unescape("Account email is too long."),pattern:$("#billingEmailPatternMsg").text()},bankAccountPaySWIFTCode:{required:unescape("SWIFT code is required.")},PrepaidCardNumber:{PrepaidCardNumbersCheck:unescape("You must enter 25 character Microsoft gift card code.")},invoicePONumber:{maxlength:unescape("Invoice PO number is too long.")},invoiceHolderName:{required:unescape("Recipient is required."),maxlength:unescape("Recipient is too long.")},PicvAmount:{pattern:$("#PicvAmountPatternMsg").text(),PICVCheck:unescape("At least one of the two fields is required.")},PicvCode:{pattern:$("#PicvCodePatternMsg").text(),PICVCheck:unescape("At least one of the two fields is required.")},CountryCode:{required:unescape("Country/region code is required."),pattern:$("#CountryCodePatternMsg").text()},PhoneNumber:{required:unescape("Phone number is required."),pattern:$("#PhoneNumberPatternMsg").text()},VerificationCode:{required:unescape("Verification code is required."),pattern:$("#VerificationCodePatternMsg").text()},ssn:{required:unescape("Social security number is required."),minlength:unescape("Social security number is too short."),maxlength:unescape("Social security number is too long."),pattern:$("#ssnPatternMsg").text()},SSNFirstName:{required:unescape("First name is required."),maxlength:unescape("First name is too long."),pattern:$("#SSNFirstNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},SSNLastName:{required:unescape("Last name is required."),maxlength:unescape("Last name is too long."),pattern:$("#SSNLastNamePatternMsg").text(),NonCCNumberSuspicious:unescape("Please enter valid information.")},inicisInfo:{required:unescape("Card/Phone Number is required.")},comments:{required:unescape("Comments is required."),maxlength:unescape("Comments is too long."),pattern:$("#commentsPatternMsg").text()},optionalTaxID:{maxlength:unescape("Tax ID is long."),pattern:$("#optionalTaxIDPatternMsg").text()},nationality:{required:unescape("Nationality is required.")},monthOfBirthday:{required:unescape("Birthday is required."),IsBirthday:unescape("Birthday is invalid.")},dayOfBirthday:{required:unescape("Birthday is required."),IsBirthday:unescape("Birthday is invalid.")},yearOfBirthday:{required:unescape("Birthday is required."),minlength:unescape("The year of birthday is too short."),maxlength:unescape("The year of birthday is too long."),pattern:$("#yearOfBirthdayPatternMsg").text(),IsBirthday:unescape("Birthday is invalid.")},SEPABankName:{required:unescape("Bank name is required.")},signature:{required:unescape("Signature is required."),equalTo:unescape("The signed name doesn&#8217;t match to the account holder name.")},signAndAuthCity:{required:unescape("Signature city is required."),maxlength:unescape("")},signatureDate:{required:unescape("Signature date is required.")},bapType:{required:unescape("Account type is required.")}}

    });

    function localFormSubmit(form) {
        
        // Hide the tokenization error element, if it is currently being displayed.
        $('#tokenizationError').hide();

        if (SHOW_SUBMIT_CONFIRMATION) {
            if (isConfirmed) {
                submitForm(form);
            } else {
                showSubmitConfirmation(form, false);
            }
        } else {
            submitForm(form);
        }
    }

    // Data Modifications
    

    //Stored Value
    $("#newsv .payment-type input").live('change', function () {
        $("#btnSave").attr("disabled", !STORED_VALUE_ISENOUGH);
        $("#newsv > div[class='hidden']").hide();
        if ($(this).is(":checked")){
            $("#" + this.id + "_div").show();
            $("#pcs_svstype").val(this.id);
        }
        PageHeightChangeNotice();
    });

    var prepaidCardNumberOldValue = "";
    $("#PrepaidCardNumber").live('paste keyup focusout', function (e) {
        //formate user input like this: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        if (e) {
            e = e;
        } else {
            e = window.event;
        }
        if(e.which) {
            var keycode = e.which;
        } else {
            var keycode = e.keyCode;
        }

        var oString = $.trim($(this).val().toUpperCase());
        var needValidation = false;
        if(oString.length)
        {
            var newString = ParseChar(oString);
            var formated = AutoFormat(newString);
            if(e.type == "keyup")
            {
              //ctrl keycode is 17, e.metaKey for Mac
                var ctrlDown = e.ctrlKey || e.metaKey;
              var ctrlKey = 17, vKey = 86, cKey = 67;

              if(keycode >= 48 && !(ctrlDown && (keycode == cKey || keycode == vKey))){
                    $(this).val(formated);
                    needValidation = true;
                }
            }else
            {
                 $(this).val(formated);
                 needValidation = true;
            }
        }
        //validate user input
        //client validate fail, show the client error message and doesn's show the text of prepaid_validation_message
        if(!$("#PCSBodyForm").validate().element(this))
        {
            $('#prepaid_validation_message').hide();
            return;
        }

        var inputLength = $.trim($(this).val()).length;
        if (inputLength != 29 || prepaidCardNumberOldValue == $(this).val()) {
            $('#prepaid_validation_message').show();
            return;
        }

        if(needValidation)
        {
            $('#prepaid_validation_message').show();
            $('#prepaid_validation_message').html('<span class="font-gray1">' + unescape("verifying...") +'</span>');
            // start posting form
            $.post('/PCSV2/msstore/liverps/pcs/ValidateToken', $('#PrepaidCardNumber').serialize(), function (data) {
                $('#prepaid_validation_message').html(data);
            });
            prepaidCardNumberOldValue = $(this).val();
        }
    });

    //auto change user input to upper case
    $(".upperCase").live('focusout', function (e) {
        var oString = $.trim($(this).val());
        if(oString.length)
        {
            $(this).val(oString.toUpperCase());
        }
    });

    //fill address info
    if(PCS.RequestForm != undefined && PCS.RequestForm != null){
        PCS.FillAccountInfo(PCS.RequestForm);
    }else{
        PCS.FillAccountInfo(PCS.Profile);
    }

    //Set forbidden paste
    ForbiddenInputPaste(INPUT_FORBIDDEN_PASTE_LIST);

    ReadyText(BOOL_SUPPORT_ACCESSIBILITY);
    $("#accountCPFAndCNPJLabel input:radio").live("click", PCS.BPRadioClick);
    PCS.Views.putBankPayViews();
    //for dropdown list styele in view page as same as BAM
    DropdownListClickForBAM();

    PCS.Views.putAllViews();

    $("#PageContainer").css("display","block");
    $("#btnSave").attr('disabled', false);

    $("input[name='pcs_spiid'][category!='purchasesv']:radio").click(PCS.RadioClick).each(PCS.EachEvent);
    //for pobo cvv
    $("#btnCVVSave").live('click', CVVValidateClick);
    //set input hint
    InputHint.HintInit(INPUT_HINT_LIST);

    //Set ViewMode
    ViewMode.Init(ViewMode.ModeType);
    //Set DefaultSelectedPIId
    var defaultPIID = unescape("%24fvo");

    switch(defaultPIID) {
        case "$newlwp":
            // first LWP, used for piid=11(select LWP)
            $("input[name=pcs_spiid][cardtype=lwp]:radio").first().trigger("click");
            $("input[name=pcs_spiid][cardtype=lwp]:radio").first().attr('checked','checked');
            break;
        case "$fvo":
            $("input[name=pcs_spiid]:radio").first().trigger("click");
            $("input[name=pcs_spiid]:radio").first().attr('checked','checked');
            break;
        case "$fepi":
            if ($("input[name=pcs_spiid][category='ed']:radio").length > 0) {
                $("input[name=pcs_spiid][category='ed']:radio").first().trigger("click");
                $("input[name=pcs_spiid][category='ed']:radio").first().attr('checked','checked');
            }
            else {
                $("input[name=pcs_spiid]:radio").first().trigger("click");
                $("input[name=pcs_spiid]:radio").first().attr('checked','checked');
            }
            break;
        // Should not use default since there may be radio button checked already.
    }

    if(NeedPostMessageSubmit)
    {
       $("#confirmationConfirm").click(PCS.PostMessage.NotifyOnSubmit);
    }

    //Select submit item
    if(PCS.RequestForm && PCS.RequestForm.pcs_svstype != null && PCS.RequestForm.pcs_svstype != "") {
        $("#"+PCS.RequestForm.pcs_svstype).click().change();
    }

    //show pop for agent flow
    var needShowNormalConsent = false;
    //from agent account page needn't show agent pop up again
    if(false)
    {
        //first show agent pop
         Popup.CancelUrl = unescape("%3ferrorCode%3d11");
         Popup.CookieName = "PCSContsentAgreeDupm";
         Popup.NeedShowNormalConsent = needShowNormalConsent;
         if(Popup.IsAgree("dupm") && needShowNormalConsent)
         {
            Popup.CookieName = "PCSContsentAgreeMkt";
            if(!Popup.IsAgree("mkt"))
            {
                Popup.Show("PopupConsent", "ShadeDiv", "mkt");
                $("#PopupConsentOK").bind("click", function() { Popup.OKClick("mkt")});
            }
         } else {
            Popup.Show("PopupConsent", "ShadeDiv", "dupm");
            $("#PopupConsentOK").bind("click", function() { Popup.OKClick("dupm");});
        }

        $("#PopupConsentCancel").click(Popup.CancelClick);

        setTimeout("$('#PopupConsent').scrollablePanel();", 200);
    }//Show Consent for normal
    else if(needShowNormalConsent){
        //set cancel url
        Popup.CancelUrl = unescape("%3ferrorCode%3d11");
        Popup.CookieName = "PCSContsentAgreeMkt";
        Popup.Show("PopupConsent", "ShadeDiv", "mkt");
        $("#PopupConsentOK").bind("click", function() { Popup.OKClick("mkt");});
        $("#PopupConsentCancel").click(Popup.CancelClick);

        setTimeout("$('#PopupConsent').scrollablePanel();", 200);
    }

        SubscriptionAgreement(false);
        if(isACH)
        {
            ACHAuthAgreement(true);
        }

    //MSPASUI
    if(typeof(MAPSUI) != "undefined"){
        MAPSUI.PageReady();
    }
    if(typeof(WPApollo) != "undefined"){
        WPApollo.PageReady();
    }

    //Handle apply Win10 CSS class name in PCS page
    if(isDynamicCSS2Win10)
    {
        ApplyWin10ClassName();
        // When PCS is using CXHStyle.cshtml, buttons are outside of the form so bind the btnSave to submit PCSBodyForm
        $('#btnSave').click(function() {
            $('#PCSBodyForm').submit();
        });
    }
});

function CVVValidateClick() {
    if (!$("#cvm").valid()) {
        return;
    }

    //use click button once
    $("#btnCVVSave").attr('disabled','disabled');
    $("#PageContainer").css("display","block");
    //ajax call cvvresume action
    $.ajax({
        type: "POST",
        url: '/PCSV2/msstore/liverps/pcs/CVVValidate',
        data: { piid: $("#piid").val(), __RequestVerificationToken: $("input[name='__RequestVerificationToken']").val(), cvm: $("#cvm").val(), accountid: ACCOUNT_ID },
        dataType: "json",
        error: function (json) {
            //use can do cvv again
            $("#btnCVVSave").attr('disabled', false);
            $("#cvvresult").html(CVVFaile).addClass("color-red");
        },
        success: function (json) {
            //reload page
            FormSubmit("post", "");
            //enable next button
            if ($("#btnSave").is(":disabled")) {
                $("#btnSave").attr('disabled', false);
            }
        }
    });
}

function FormSubmit(method, action) {
            var frm = $("#PCSBodyForm")[0];
            frm.method = method;
            frm.action = action;
            frm.submit();
        }

$(document).ready(function () {
    $("#btnReset").click(function () {

        $('#pageUnloadInitiator').val("cancel");

        if (typeof LogEvent != 'undefined') {
            LogEvent({ "EventName" : "PageCancel", "CorrelationId": "a35a6e03-9d67-4b19-9a3b-2354518a22bb", "SessionGuid" : "1831ce5f-43cb-491c-813b-92d028269cff", "Market": "us", "Partner": "msstore", "SubPartner": "getsupport" });
        }

        location.href='/PCSV2/msstore/liverps/pcs/DoCancel?CorrelationId=a35a6e03-9d67-4b19-9a3b-2354518a22bb';
    });

    // TODO: this is a hotfix for BAM-MSA.
    // 1) code should be refactored;
    // 2) should make the logic work in all PCS page.
    if(PARTNER == "bam-msa") {
        $(window).bind('resize', function(e){
            PageHeightChangeNotice();
        });
    }
})

</script>

        <div class="clear"></div>
    </div>


</body></html>